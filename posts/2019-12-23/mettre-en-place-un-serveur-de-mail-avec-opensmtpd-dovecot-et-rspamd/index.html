<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd &#183; poolp.org</title><meta name=title content="Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd &#183; poolp.org"><link rel=canonical href=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/><link type=text/css rel=stylesheet href=/css/main.bundle.min.a541a0fe3bf78817235f39ab69ca97b5b6eed7dd6221f8c6cc58aa90096f4da91424aeb15d985a623c2524fa176998883a5c35b9f73065a7a907d982e43d8efb.css integrity="sha512-pUGg/jv3iBcjXzmracqXtbbu191iIfjGzFiqkAlvTakUJK6xXZhaYjwlJPoXaZiIOlw1ufcwZaepB9mC5D2O+w=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ+dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5+a8AgFUkA==" data-copy data-copied></script>
<script src=/js/zoom.min.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd"><meta property="og:description" content="TL;DR: - Pas de r√©sum√©, j'ai pass√© des heures √† traduire, vous allez passer des minutes √† lire ;) - OK‚Ä¶ J'ai expliqu√© avec BIEN TROP DE D√âTAILS comment mettre en place un serveur de mail Merci √† mes sponsors !"><meta property="og:type" content="article"><meta property="og:url" content="https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/"><meta property="og:image" content="https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/feature.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-23T07:57:00+02:00"><meta property="article:modified_time" content="2019-12-23T07:57:00+02:00"><meta property="og:site_name" content="poolp.org"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/feature.png"><meta name=twitter:title content="Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd"><meta name=twitter:description content="TL;DR: - Pas de r√©sum√©, j'ai pass√© des heures √† traduire, vous allez passer des minutes √† lire ;) - OK‚Ä¶ J'ai expliqu√© avec BIEN TROP DE D√âTAILS comment mettre en place un serveur de mail Merci √† mes sponsors !"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd","headline":"Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd","abstract":"TL;DR: - Pas de r√©sum√©, j\u0027ai pass√© des heures √† traduire, vous allez passer des minutes √† lire ;) - OK‚Ä¶ J\u0027ai expliqu√© avec BIEN TROP DE D√âTAILS comment mettre en place un serveur de mail Merci √† mes sponsors !","inLanguage":"en","url":"https:\/\/poolp.org\/posts\/2019-12-23\/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd\/","author":{"@type":"Person","name":""},"copyrightYear":"2019","dateCreated":"2019-12-23T07:57:00\u002b02:00","datePublished":"2019-12-23T07:57:00\u002b02:00","dateModified":"2019-12-23T07:57:00\u002b02:00","mainEntityOfPage":"true","wordCount":"8519"}]</script><script src=/lib/jquery/jquery.slim.min.js integrity></script>
<link rel=stylesheet href=/css/syntax.css><link rel=stylesheet href=/css/custom.css><script>for(var elements=document.querySelectorAll(".discord-dialog__close-button, .discord-dialog"),i=0;i<elements.length;i++)elements[i].addEventListener("click",function(){toggle(".discord-dialog")})</script><style>@import "https://fonts.cdnfonts.com/css/whitney-2";.discord-dialog *,.discord-dialog :after,.discord-dialog :before{box-sizing:inherit}.discord-dialog a{text-decoration:none}@keyframes discord-dialog__transition{0%{opacity:0;transform:translateY(16px)}100%{opacity:1;transform:translateY(0)}}.discord-dialog{-webkit-tap-highlight-color:transparent;box-sizing:border-box;display:none;z-index:2147483647;position:fixed;max-width:288px;right:0;bottom:0;margin:18px;border-radius:10px;font-family:Whitney,sans-serif;background:#2e3136;color:#72767d;box-shadow:0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12),0 8px 10px -5px rgba(0,0,0,.4);transition:opacity .3s cubic-bezier(.25,.8,.25,1),transform .3s cubic-bezier(.25,.8,.25,1);animation:discord-dialog__transition .2s}.discord-dialog--active{display:block}.discord-dialog__container{font-size:14px;line-height:1.2;color:#99aab5;padding:8px 28px 28px}.discord-dialog__logo{display:none;width:auto;margin-top:5px;height:24px}.discord-dialog__logo path{fill:#fff}.discord-dialog__close-button{position:absolute;right:0;padding:16px;cursor:pointer}.discord-dialog__close-button svg{height:20px;width:20px}.discord-dialog__close-button svg path{fill:#ccc}.discord-dialog__close-button:hover{opacity:.8}.discord-dialog__close-button:active{opacity:.4}.discord-dialog__footer{padding:10px 20px}.discord-dialog__guild-icon{border-radius:50%;width:64px;display:block;height:auto;margin:16px 0}.discord-dialog__guild{font-size:24px;line-height:30px;margin-bottom:12px;font-weight:700;color:#fff}.discord-dialog__btn{background:#7289da;color:#fff;text-align:center;display:block;border-radius:1px;margin:8px;font-size:16px;line-height:24px;border-radius:3px;text-align:center;padding:12px 16px;position:relative;top:-6px;box-shadow:0 2px 4px rgba(0,0,0,.3);transition:box-shadow .3s cubic-bezier(.25,.8,.25,1),background .3s cubic-bezier(.25,.8,.25,1)}.discord-dialog__btn:hover{background:#8095de}.discord-dialog__btn:active{background:#677bc4}.discord-dialog__explainer{display:block;margin:2px 8px;color:#7289da;font-size:12px;text-align:right;top:-6px}.discord-dialog__explainer:hover{opacity:.8}.discord-dialog__explainer:active{opacity:.6}.discord-button{-webkit-tap-highlight-color:transparent;box-sizing:border-box;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);position:fixed;bottom:0;right:0;z-index:50;margin:23.5px;padding:15.5px;border-radius:50%;background:#7289da;cursor:pointer;transition:box-shadow .3s cubic-bezier(.25,.8,.25,1),background .3s cubic-bezier(.25,.8,.25,1);display:flex;text-align:center;align-items:center;justify-content:center}.discord-button svg{height:28px;width:28px;transition:background .3s cubic-bezier(.25,.8,.25,1)}.discord-button svg path{fill:#fff}.discord-button:hover{box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}.discord-button:hover svg{opacity:.6}.discord-button:active{box-shadow:0 10px 20px rgba(0,0,0,.19),0 6px 6px rgba(0,0,0,.23)}.discord-button:active svg{opacity:.4}</style><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><span class=sr-only>poolp.org</span>
<img src=/img/poolp_bing.png width=512 height=512 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=poolp.org></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">poolp.org</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=https://github.com/poolpOrg/ target=_blank class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title>Github</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=https://github.com/poolpOrg/ target=_blank class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title>Github</p></a></li></ul><hr><ul class="flex mt-4 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li class=mb-1><a href=/categories/technology/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title=technology>Technology</p></a></li><li class=mb-1><a href=/categories/music/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title=music>Music</p></a></li><li class=mb-1><a href=/categories/personal/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-gray-900" title=personal>Personal</p></a></li></ul></div></label></div></div><div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3" style=margin-top:-15px><div class="hidden md:flex items-center space-x-5"><a href=/categories/technology/ class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title=technology>Technology</p></a><a href=/categories/music/ class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title=music>Music</p></a><a href=/categories/personal/ class="flex items-center"><p class="text-xs font-light text-gray-500 hover:text-gray-900" title=personal>Personal</p></a></div></div></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="w-full h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style=background-image:url(/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/feature_hu91f0ddb58ed565371ed0fd41f3a129e8_60088_1200x0_resize_box_3.png)></div><br><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="dark:text-neutral-300 text-sm"><b>A HUGE thanks ‚ù§Ô∏è</b> goes to my (<b>sadly very few üò¢</b>) sponsors on
<u><b><a href=https://github.com/sponsors/poolpOrg>github</a></b></u> and
<u><b><a href=https://www.patreon.com/gilles>patreon</a></b></u>:
your support keeps my motivation, website and projects running !</span></div><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>poolp.org</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/>Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Mettre en place un serveur de mail avec OpenSMTPD, Dovecot et Rspamd</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2019-12-23 07:57:00 +0200 +0200">23 December 2019</time><span class="px-2 text-primary-500">&#183;</span><span>8519 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">40 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/poolpOrg/poolp.org/tree/master/content/posts/2019-12-23/index.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M490.3 40.4c21.9 21.87 21.9 57.33.0 79.2l-30 30.1-98-97.98 30.1-30.06C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7 339.7 74.34l98 97.96L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2l-88.8 29.6C150.1 385.6 141.5 383.4 135 376.1 128.6 370.5 126.4 361 129.2 352.4l29.6-88.8C161.6 255.3 166.2 247.8 172.4 241.7v0zM192 63.1c17.7.0 32 15.23 32 32 0 18.6-14.3 32-32 32H96c-17.67.0-32 15.2-32 32V416c0 17.7 14.33 32 32 32H352c17.7.0 32-14.3 32-32V319.1c0-16.8 14.3-32 32-32s32 15.2 32 32V416c0 53-43 96-96 96H96c-53.02.0-96-43-96-96V159.1c0-53 42.98-96 96-96h96z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"><div style=cursor:pointer onclick='window.open("/authors/gilles/","_self")'>Gilles Chehade</div></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/technology/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">technology</span></span></span></div></div><div class=flex><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/img/gilles_hu897fc9ad11a292e594efc0b9f1eaea51_1273455_192x192_fill_q75_box_center.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://poolp.org//authors/gilles class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Gilles Chehade</a><div class="text-sm text-neutral-700 dark:text-neutral-400">I&rsquo;m not a cat.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:gilles@poolp.org target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/poolpOrg target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/gilleschehade target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://social.poolp.org/@gilles target=_blank aria-label=Mastodon rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.youtube.com/gilleschehade target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitch.tv/poolporg target=_blank aria-label=Twitch rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M391.17 103.47H352.54v109.7h38.63zM285 103H246.37V212.75H285zM120.83.0 24.31 91.42V420.58H140.14V512l96.53-91.42h77.25L487.69 256V0zM449.07 237.75l-77.22 73.12H294.61l-67.6 64v-64H140.14V36.58H449.07z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="dark:text-neutral-300 text-sm"><b>WANT TO HELP ?</b><br><br>If you like this article or if you don't like it but still value my work,
<b>please ‚ù§Ô∏è</b> consider <b>sharing on social networks</b> to boost its visibility:
this can land me freelance gigs and sponsorships,
which buys me more time to write new articles and work on new projects.
Also <b>consider leaving <u><a href=#comments>comments</a></u></b> at the bottom of the article,
even if just for feedback,
this helps make the website more... lively ? üòä
OH... almost forgot but <b>there's a <u><a href=https://discord.com/invite/YC6j4rbvSk>Discord</a></u> server too</b>,
feel free to hop in !<section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;text=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;description=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;quote=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;subject=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section></span></div><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#merci-√†-mes-sponsors->Merci √† mes sponsors !</a></li><li><a href=#o√π-est-ce-que-jai-d√©j√†-lu-√ßa->O√π est-ce que j&rsquo;ai d√©j√† lu √ßa ?</a></li><li><a href=#cet-article-est-pour-les-techies-et-les-sysadmins>Cet article est pour les techies et les sysadmins</a></li><li><a href=#ehlo-hypnocat>EHLO hypno.cat</a></li><li><a href=#pr√©-requis>Pr√©-requis</a></li><li><a href=#la-stack-technique>La stack technique</a></li><li><a href=#me-rendre-accessible>Me rendre accessible</a></li><li><a href=#me-faire-bien-voir>Me faire bien voir</a></li><li><a href=#annoncer-quelles-machines-sont-autoris√©es-√†-√©mettre-pour-mon-domaine>Annoncer quelles machines sont autoris√©es √† √©mettre pour mon domaine</a></li><li><a href=#prouver-que-jai-autoris√©-le-message-lui-m√™me>Prouver que j&rsquo;ai autoris√© le message lui m√™me.</a></li><li><a href=#dire-aux-autres-quoi-faire-en-cas-derreurs-spf-et-dkim-avec-dmarc>Dire aux autres quoi faire en cas d&rsquo;erreurs SPF et DKIM avec DMARC</a></li><li><a href=#obtenir-un-certificat-pour-tls>Obtenir un certificat pour TLS</a></li><li><a href=#installer-et-configurer-rspamd>Installer et configurer Rspamd</a></li><li><a href=#configurer-opensmtpd>Configurer OpenSMTPD</a></li><li><a href=#quelques-mots-au-sujet-de-senderscore>Quelques mots au sujet de SenderScore</a></li><li><a href=#installer-et-configurer-dovecot>Installer et configurer Dovecot</a></li><li><a href=#apprendre-√†-dovecot-√†-entrainer-rspamd>Apprendre √† Dovecot √† entrainer Rspamd</a></li><li><a href=#tester-le-tout>Tester le tout</a></li><li><a href=#cool-on-a-fini>Cool, on a fini</a></li><li><a href=#quelle-est-la-prochaine-√©tape->Quelle est la prochaine √©tape ?</a></li><li><a href=#est-ce-quon-a-vraiment-fini->Est-ce qu&rsquo;on a vraiment fini ?</a></li></ul></li></ul></nav></div></details><details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#merci-√†-mes-sponsors->Merci √† mes sponsors !</a></li><li><a href=#o√π-est-ce-que-jai-d√©j√†-lu-√ßa->O√π est-ce que j&rsquo;ai d√©j√† lu √ßa ?</a></li><li><a href=#cet-article-est-pour-les-techies-et-les-sysadmins>Cet article est pour les techies et les sysadmins</a></li><li><a href=#ehlo-hypnocat>EHLO hypno.cat</a></li><li><a href=#pr√©-requis>Pr√©-requis</a></li><li><a href=#la-stack-technique>La stack technique</a></li><li><a href=#me-rendre-accessible>Me rendre accessible</a></li><li><a href=#me-faire-bien-voir>Me faire bien voir</a></li><li><a href=#annoncer-quelles-machines-sont-autoris√©es-√†-√©mettre-pour-mon-domaine>Annoncer quelles machines sont autoris√©es √† √©mettre pour mon domaine</a></li><li><a href=#prouver-que-jai-autoris√©-le-message-lui-m√™me>Prouver que j&rsquo;ai autoris√© le message lui m√™me.</a></li><li><a href=#dire-aux-autres-quoi-faire-en-cas-derreurs-spf-et-dkim-avec-dmarc>Dire aux autres quoi faire en cas d&rsquo;erreurs SPF et DKIM avec DMARC</a></li><li><a href=#obtenir-un-certificat-pour-tls>Obtenir un certificat pour TLS</a></li><li><a href=#installer-et-configurer-rspamd>Installer et configurer Rspamd</a></li><li><a href=#configurer-opensmtpd>Configurer OpenSMTPD</a></li><li><a href=#quelques-mots-au-sujet-de-senderscore>Quelques mots au sujet de SenderScore</a></li><li><a href=#installer-et-configurer-dovecot>Installer et configurer Dovecot</a></li><li><a href=#apprendre-√†-dovecot-√†-entrainer-rspamd>Apprendre √† Dovecot √† entrainer Rspamd</a></li><li><a href=#tester-le-tout>Tester le tout</a></li><li><a href=#cool-on-a-fini>Cool, on a fini</a></li><li><a href=#quelle-est-la-prochaine-√©tape->Quelle est la prochaine √©tape ?</a></li><li><a href=#est-ce-quon-a-vraiment-fini->Est-ce qu&rsquo;on a vraiment fini ?</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><blockquote><b>TL;DR:</b><br><pre><code>- Pas de r√©sum√©, j'ai pass√© des heures √† traduire, vous allez passer des minutes √† lire ;)
- OK‚Ä¶ J'ai expliqu√© avec BIEN TROP DE D√âTAILS comment mettre en place un serveur de mail
</code></pre></blockquote><div id=merci-√†-mes-sponsors- class=anchor></div><h2 class="relative group">Merci √† mes sponsors !
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#merci-%c3%a0-mes-sponsors- aria-label=Anchor>#</a></span></h2><p>Un <strong>√©norme</strong> merci aux gens qui me sponsorisent sur <a href=https://www.patreon.com/gilles target=_blank>patreon</a> ou <a href=https://github.com/sponsors/poolpOrg target=_blank>github</a>.</p><div id=o√π-est-ce-que-jai-d√©j√†-lu-√ßa- class=anchor></div><h2 class="relative group">O√π est-ce que j&rsquo;ai d√©j√† lu √ßa ?
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#o%c3%b9-est-ce-que-jai-d%c3%a9j%c3%a0-lu-%c3%a7a- aria-label=Anchor>#</a></span></h2><p>En Ao√ªt,
j&rsquo;ai publi√© un petit article intitul√© &ldquo;<a href=https://poolp.org/posts/2019-08-30/you-should-not-run-your-mail-server-because-mail-is-hard/ target=_blank>
You should not run your mail server because mail is hard</a>&rdquo; (&ldquo;Vous ne devriez pas h√©berger votre serveur de mail parce que c&rsquo;est dur&rdquo;) qui √©tait, en gros, mon opinion sur les diff√©rentes raisons qui poussent les gens √† d√©courager l&rsquo;h√©bergement de mails.
De mani√®re tr√®s inattendue, l&rsquo;article est devenu assez populaire, atteignant 100K lectures et continuant √† recevoir des visites et des commentaires plusieurs mois apr√®s sa publication.</p><p>En Septembre, j&rsquo;ai publi√© un autre article beaucoup plus long intitul√© &ldquo;<a href=https://poolp.org/posts/2019-09-14/setting-up-a-mail-server-with-opensmtpd-dovecot-and-rspamd/ target=_blank>
Setting up a mail server with OpenSMTPD, Dovecot and Rspamd</a>&rdquo; (&ldquo;Installer un serveur de mail avec OpenSMTPD, Dovecot et Rspamd&rdquo;) qui d√©crivait pas √† pas, de fa√ßon tr√®s d√©taill√©e, les √©tapes pour installer un serveur de mail complet jusqu&rsquo;√† la livraison des e-mails en bo√Æte de r√©ception chez un gros h√©bergeur de mail am√©ricain.
L&rsquo;article est devenu lui aussi plut√¥t populaire, sans pour autant atteindre le niveau du pr√©cedent article moins technique et sp√©cifique, mais atteignant 40K lectures et continuant √©galement √† recevoir des visites et des commentaires plusieurs mois apr√®s la publication.
<strong>Le contenu que vous vous appr√™tez √† lire est la traduction de cet article technique.</strong></p><p>C&rsquo;est mon second article r√©dig√© en fran√ßais depuis des ann√©es, je vous demande donc un peu d&rsquo;indulgence :
si vous trouvez des fautes, vous pouvez me les remonter pour que je les corrige, ou faire une <a href=https://github.com/poolpOrg/poolp.org/ target=_blank>pull request</a> pour les techies.</p><p><strong>Cet article est DENSE</strong> parce que je vais vous tenir la main √† un niveau <strong>frisant l&rsquo;absurdit√©</strong> en expliquant chacune de mes actions et le pourquoi du comment.
D&rsquo;un point de vue purement technique, sans explications, l&rsquo;article pourrait probablement tenir en quelques paragraphes.</p><p>N&rsquo;h√©sitez pas √† <strong>partager la publication</strong> √† l&rsquo;aide des icones en fin d&rsquo;article et √† la commenter &lt;3</p><p>Ah, et tant que je vous ai sous la main, je vous recommande chaudement la lecture de mon article non technique <a href=https://poolp.org/posts/2019-12-15/decentralisons-smtp-pour-le-bien-commun/ target=_blank>&ldquo;D√©centralisons SMTP pour le bien commun&rdquo;</a> qui aborde certaines des raisons pour lesquelles il nous faut davantage de serveurs de mail.</p><p>Bonne lecture !</p><div id=cet-article-est-pour-les-techies-et-les-sysadmins class=anchor></div><h2 class="relative group">Cet article est pour les techies et les sysadmins
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cet-article-est-pour-les-techies-et-les-sysadmins aria-label=Anchor>#</a></span></h2><p>L&rsquo;auto-h√©bergement requiert un minimum de connaissances et de motivation.
Ce n&rsquo;est pas un truc qui se fait en deux clics, il vous faut des connaissances minimales et avoir l&rsquo;envie d&rsquo;y d√©dier un peu de votre temps.
Si vous n&rsquo;avez jamais touch√© une zone DNS ou si vous pensez que prendre une heure pour configurer quelque chose est une t√¢che difficile, alors autant vous pr√©venir de suite :
<strong>√ßa ne va pas √™tre simple</strong>.
Je ne vous recommande pas vous lancer dans l&rsquo;aventure sauf si vous <strong>VOULEZ</strong> avoir √† apprendre une tonne de trucs.</p><p>Si vous √™tes un sysadmin familier avec le travail de sysadmin, alors la plupart de votre travail de sysadmin est d√©j√† consid√©rablement plus dur que mettre en place une instractructure mail.
Pour vous, <strong>le mail ne sera pas quelque chose de difficile</strong>.</p><div id=ehlo-hypnocat class=anchor></div><h2 class="relative group">EHLO hypno.cat
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ehlo-hypnocat aria-label=Anchor>#</a></span></h2><p>Pour cet article, nous mettrons en place un serveur de mail pour <a href=https://hypno.cat target=_blank>hypno.cat</a>, un petit site web pour mon (hypoth√©tique) activit√© prosp√®re d&rsquo;hypnopraticien.
J&rsquo;ai enregistr√© ce domaine il y a plusieurs ann√©es parce que j&rsquo;aimais bien le nom mais il n&rsquo;a jamais √©t√© utilis√© pour quoi que ce soit d&rsquo;autre que l&rsquo;h√©bergement d&rsquo;un <strong>merveilleux</strong> fichier anim√©.</p><center><img src=2019-09-01-newdomain.png></center><p>Google, Bing et Yahoo le connaissent ; on ne sait pas trop comment <em>(je vais du moins faire semblant de ne pas savoir)</em> et ont index√© la page d&rsquo;accueil, du coup ils ne consid√®rent pas que ce domaine vient d&rsquo;√™tre achet√© par un spammer pour imm√©diatement envoyer du mail, mais il reste virtuellement inconnu sur internet parce qu&rsquo;il n&rsquo;a aucun contenu, ne fais aucun lien, n&rsquo;est link√© depuis nul part, et n&rsquo;a jamais √©mis ou re√ßu de mail depuis ou vers personne.
C&rsquo;est un d√©tail plut√¥t important qui montre que l&rsquo;√¢ge d&rsquo;un domaine √† un impact sur la r√©putation, mais √ßa reste un crit√®re parmi d&rsquo;autres, on reparlera r√©putation dans un futur article.</p><p>Je vais le mettre en place au fur et √† mesure que j&rsquo;√©cris cet article, depuis le moment o√π j&rsquo;ai d√©marr√© un nouveau VPS jusqu&rsquo;au moment o√π j&rsquo;ai pu √©changer un mail dans les deux sens avec mon compte Gmail.
J&rsquo;ai choisi Gmail parce qu&rsquo;il est sur-repr√©sent√© dans la population et qu&rsquo;un nombre important de personnes se sont plains de probl√®mes de distribution l√†-bas.
Tr√®s personnellement, je pense que Outlook est bien pire en terme d&rsquo;interop√©rabilit√©, mais gardons √ßa pour un futur article peut-√™tre.</p><p>Les services de mail pour <a href=https://hypno.cat target=_blank>hypno.cat</a> vont fournir du mail entrant et sortant s√©curis√©s par TLS.
Ils vont permettre de soumettre des messages depuis l&rsquo;application Gmail de mon smartphone pour ne pas changer les habitudes de mes utilisateurs.
Je pourrais tout aussi bien fournir un webmail, avec <a href=https://www.rainloop.net/ target=_blank>Rainloop</a> ou <a href=https://www.roundcube.net/ target=_blank>Roundcube</a>, ou installer un client lourd comme <a href=https://www.thunderbird.net/ target=_blank>Thunderbird</a> ou <a href=http://mutt.org target=_blank>mutt</a>.
N&rsquo;importe quel client fonctionnera ; donc je ne vais pas couvrir cette partie. Il y a de nombreuses alternatives et plusieurs articles existants sur internet pour couvrir leur mise en place.
Il y a m√™me des techniques pour assister les clients √† automatiquement d√©couvrir leur configuration, mais tout √ßa reste hors du p√©rim√®tre de mon article, je ne me fais pas de soucis vous allez trouver tout seul.</p><p>Mon mail sortant passera les v√©rifications basiques de Gmail, plus pr√©cis√©ment SPF, DKIM et DMARC, qui sont plus que suffisant pour laisser le mail arriver en inbox.
Il est possible de faire <strong>beaucoup plus</strong>, mais le but de cet article est de trouver le bon √©quilibre entre faire assez de travail pour avoir bonne allure face aux autres serveurs et rester simple.</p><p>Le mail entrant sera filtr√© pour r√©duire la quantit√© de spam, soit en tuant les connexions de mauvais √©metteurs √©vidents d√®s qu&rsquo;ils sont d√©tect√©s, soit en proposant une classification du Spam dans un r√©pertoire d√©di√© pour √©viter de saturer la boite de r√©ception.</p><p>Je pourrais m&rsquo;arr√™ter l√† parce que c&rsquo;est d√©j√† un setup assez int√©ressant, mais je vais rajouter un peu de configuration pour apprendre √† Dovecot √† entrainer le filtre antispam.
Il apprendra √† reconnaitre le Spam lorsque je d√©placerai un message dans le r√©pertoire Spam, et √† reconnaitre le mail l√©gitime lorsque je d√©placerai un message hors du r√©pertoire Spam.
Cette partie est un peu plus complexe parce qu&rsquo;elle d√©pend de Sieve qui est loin d&rsquo;√™tre un bijou d&rsquo;ing√©nierie.
Si vous vous moquez de l&rsquo;apprentissage, vous pouvez sauter cette partie ; j&rsquo;ai fait sans pendant plus de dix ans. C&rsquo;est un truc sympa √† avoir mais loin d&rsquo;√™tre une obligation ; c&rsquo;est juste mon petit cadeau bonus dans cet article.</p><div id=pr√©-requis class=anchor></div><h2 class="relative group">Pr√©-requis
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pr%c3%a9-requis aria-label=Anchor>#</a></span></h2><p>Le premier pr√©-requis est de savoir o√π vous allez faire tourner votre serveur de mail.</p><p>Avec la propagation des connexions permanentes type ADSL ou FTTH (fibre), une connexion √† domicile peut √™tre tentante mais ce n&rsquo;est pas une bonne id√©e parce que les espaces d&rsquo;adressage IP des FAI sont souvent blacklist√©s, ou souffrent d&rsquo;une tr√®s mauvaise r√©putation de d√©part.
De plus, de nombreux FAI bloquent le trafic SMTP sortant pour √©viter que les machines personelles compromises se transforment en bot √† spam.
Pour moi, la meilleure option est de louer un serveur d√©di√© ou un VPS depuis une soci√©t√© d&rsquo;h√©bergement apr√®s s&rsquo;√™tre assur√© que le trafic SMTP sortant est autoris√© l√†-bas.</p><p>J&rsquo;ai lou√© mes serveurs d√©di√©s chez <a href=https://www.online.net/ target=_blank>online.net</a> ces douze derni√®res ann√©es et je suis extr√™mement satisfait.
Vous trouverez m√™me sur ce blog <a href=https://poolp.org/posts/2018-01-29/install-openbsd-on-dedibox-with-full-disk-encryption/ target=_blank>des instructions (en anglais) pour faire tourner OpenBSD</a> sur leurs serveurs comme ce n&rsquo;est pas support√© nativement.
Ils ne filtrent pas SMTP, ce qui est bien parce que vous pouvez faire tourner un serveur de mail imm√©diatement, mais les adresses IP peuvent avoir √©t√© utilis√©es pr√©alablement par de mauvais √©metteurs et il vous faudra les tester.
Si l&rsquo;adresse IP qui vous est automatiquement allou√©e n&rsquo;est pas bonne, soit il va falloir bucher pour gagner en r√©putation, soit il vous faudra en commander une additionelle en prenant bien le soin de la choisir dans un autre range, apr√®s avoir <a href=https://mxtoolbox.com/blacklists.aspx target=_blank>v√©rifi√© qu&rsquo;elle n&rsquo;est pas dans une blacklist</a>, ou qu&rsquo;elle ne <a href=https://www.senderscore.org target=_blank>souffre pas d√©j√† d&rsquo;une mauvaise r√©putation</a>.</p><p>Alternativement, pour les besoins d&rsquo;une offre commerciale que je suis en train de monter, j&rsquo;ai commenc√© √† construire une infrastructure sur <a href="https://www.vultr.com/?ref=6831037" target=_blank>vultr.com</a> (lien de parrainage).
Je ne suis l√† bas que depuis quelques mois et je changerai peut-√™tre d&rsquo;avis, mais <strong>pour l&rsquo;instant</strong> j&rsquo;en suis tr√®s satisfait.
L√†-bas, SMTP est filtr√© par d√©faut et il faut ouvrir un ticket et expliquer quel est le projet pour le trafic mail.
J&rsquo;ai expliqu√© que je ne cherchais pas √† devenir ESP et que je n&rsquo;allais pas envoyer de mail commercial de masse mais plut√¥t g√©rer de l&rsquo;h√©bergement ; ils ont √©t√© tr√®s serviables et m&rsquo;ont retir√© le filtrage le jour m√™me.</p><p>Peu importe o√π le serveur de mail sera h√©berg√©, ce que vous devez v√©rifier c&rsquo;est que :</p><ul><li>l&rsquo;h√©bergeur n&rsquo;a pas un passif avec l&rsquo;h√©bergement de spammers et qu&rsquo;il autorise SMTP</li><li>vous avez une adresse IP <strong>d√©di√©e au mail</strong></li><li>vous avez le contr√¥le du reverse DNS pour cette adresse IP</li><li>votre adresse IP n&rsquo;est pas d√©j√† sur des blacklists</li></ul><p>Tant que ces pr√©-requis sont respect√©s, vous ne devriez pas avoir trop de probl√®mes.</p><p>Comme personne n&rsquo;aime perdre de mails, il est aussi judicieux de se <strong>pr√©parer aux incidents</strong>.
On s&rsquo;en prot√®ge en utilisant un serveur secondaire pour prendre le trafic lorsque le primaire est down, ou pour re-router le trafic lorsque le primaire est en incapacit√© de router correctement.
Je ne vais pas couvrir ce sujet parce que ce n&rsquo;est pas tr√®s complexe, il s&rsquo;agit d&rsquo;installer un second serveur qui route son trafic vers le premier et de faire le bon enregistrement DNS, apr√®s avoir lu cet article vous devriez vous en sortir seul.</p><p><strong>CEPENDANT</strong>, un grand nombre de personnes ont mentionn√©s s&rsquo;√™tre d√©j√† fait blacklister et avoir perdu du mail, donc je pense que c&rsquo;est le bon moment pour donner ce conseil :
<strong>n&rsquo;h√©bergez pas vos diff√©rents serveurs au m√™me endroit</strong>.
Vous ne voulez pas avoir tous vos serveurs au m√™me endroit s&rsquo;il y a une panne de courant ou de r√©seau, et vous voulez aussi √©viter que si votre range IP est blacklist√© en dommage collat√©ral d&rsquo;un voisin malveillant, l&rsquo;adresse IP de votre serveur secondaire est &ldquo;<strong>suffisamment √©loign√©e</strong>&rdquo; pour ne pas √™tre blacklist√©e aussi.
De cette fa√ßon, si votre serveur primaire est en incapacit√© temporaire d&rsquo;√©mettre √† cause d&rsquo;un blocage, vous pouvez re-router votre trafic au-travers de votre serveur secondaire le temps que le probl√®me soit r√©solu.</p><p>J&rsquo;ai personellement eu √† g√©rer <em>un seul</em> blocage <strong>sur mon propre setup</strong> (bien plus en dehors) durant ces dix derni√®res ann√©es.
C&rsquo;est un peu chiant parce que les incidents tombent toujours au mauvais moment et que ce n&rsquo;est jamais fun, mais j&rsquo;ai re-rout√© le trafic au-travers d&rsquo;un serveur secondaire pour le r√©tablir, rempli un formulaire de d√©listage en apportant la preuve que j&rsquo;√©tais un √©metteur l√©gitime, puis re-rout√© le trafic par mon serveur primaire une fois le probl√®me r√©solu.
On est <strong>tr√®s loin du probl√®me insurmontable</strong> qu&rsquo;en font un certain nombre de personnes.</p><p><strong>Pas de stress pour ceux qui ont un plan pour les pannes avant qu&rsquo;elles ne surviennent</strong>.</p><div id=la-stack-technique class=anchor></div><h2 class="relative group">La stack technique
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#la-stack-technique aria-label=Anchor>#</a></span></h2><p>Je vais d√©marrer un nouveau VPS chez <a href="https://www.vultr.com/?ref=6831037" target=_blank>vultr.com</a> (toujours un lien de parrainage), installer la derni√®re version d&rsquo;<a href=https://www.openbsd.org target=_blank>
OpenBSD</a>
(<a href=https://ftp.eu.openbsd.org/pub/OpenBSD/snapshots/amd64/ target=_blank>
snapshot</a>) parce que c&rsquo;est mon syst√®me de pr√©f√©rence (installation non couverte dans cet article), et construire mon syst√®me de mail par dessus.
Je vais partir du principe que nous sommes sous OpenBSD tout le reste de cet article, mais √† l&rsquo;exception de certaines commandes sp√©cifiques pour installer des packages, la configuration est tr√®s similaire d&rsquo;un syst√®me √† un autre.
Si vous √™tes assez grands pour faire tourner un serveur de mail, vous √™tes assez grands pour adapter des chemins, remplacer <code>doas</code> par <code>sudo</code>, et sinon‚Ä¶ installez OpenBSD !</p><center><img src=https://opensmtpd.org/images/opensmtpd.png></center><p>Pour la couche SMTP, qui est en charge de transf√©rer des messages entre deux h√¥tes ind√©pendemment de la mani√®re dont les utilisateurs vont y acc√©der, j&rsquo;utiliserais le logiciel <a href=https://www.OpenSMTPD.org/ target=_blank>OpenSMTPD</a>.
Il s&rsquo;agit du serveur SMTP par d√©faut pour le syst√®me d&rsquo;exploitation OpenBSD et il y a une version portable <a href=https://github.com/OpenSMTPD/OpenSMTPD target=_blank>disponible sur Github</a> avec des instructions pour le construire. Il est √©galement disponible dans <a href=https://repology.org/project/opensmtpd/badges target=_blank>les d√©p√¥ts de packages de diff√©rents syst√®mes et distributions Linux</a>, peut-√™tre tout juste √† un <code>pkg</code>, un <code>rpm</code> ou un <code>apt</code> de vous.</p><p>Les instructions de cet article sont pour la <strong>version 6.6.0</strong> ou ult√©rieure, elles <strong>ne fonctionneront pas</strong> sur des versions pr√©c√©dentes.
Si votre syst√®me ne fournit pas de package √† jour, vous pouvez tenter de demander au mainteneur de le mettre √† jour ou alors tenter d&rsquo;en devenir mainteneur.
Il vous faudra construire le package manuellement √† partir du dernier tag contenant un <code>p</code>, pour <code>portable</code>, dans son nom <a href=https://github.com/OpenSMTPD/OpenSMTPD/tags target=_blank>sur Github</a>.</p><center><img src=https://www.dovecot.org/typo3conf/ext/dvc_content/Resources/Public/Images/dovecot_logo_vector.svg></center><p>Pour la couche IMAP, qui permet aux utilisateurs de r√©cup√©rer les messages qu&rsquo;ils ont re√ßus et y acc√©der depuis leurs smartphones ou webmail, j&rsquo;utiliserais la derni√®re version de <a href=https://www.dovecot.org target=_blank>Dovecot</a>.
J&rsquo;utiliserai √©galement le package <code>Dovecot-Pigeonhole</code>, qui permettera d&rsquo;entra√Æner notre solution antispam en lui faisant apprendre ce qui est du Spam et ce qui est du Ham.
Si vous souhaitez utiliser un client console, en ssh, comme <code>mutt</code> par exemple, pas besoin de cette couche car OpenSMTPD peut distribuer dans une boite mail locale √† laquelle les clients mail peuvent acc√©der en direct.
Dans cet article, nous configurerons IMAP parce que nous voulons que les mails puissent √™tre consult√©s depuis un smartphone comme une personne lambda.</p><center><img src=https://camo.githubusercontent.com/ea57696ebeee9a4a6668347acf7ebd8ef8f74ee7/68747470733a2f2f727370616d642e636f6d2f696d672f727370616d645f6c6f676f5f626c61636b2e706e67></center><p>Enfin, pour la couche de filtrage du spam, j&rsquo;utiliserai l&rsquo;excellent <a href=https://www.rspamd.com target=_blank>Rspamd</a> qui est bien plus qu&rsquo;une <strong>simple</strong> solution antispam.
Il fournit des m√©thodes de filtrage moderne, mais permet √©galement l&rsquo;int√©gration de filtrage antivirus, de signature DKIM, et d&rsquo;une tonne de modules que vous pouvez choisir d&rsquo;activer ou non pour r√©gler plus finement votre setup.
Dans cet article, nous utiliserons tout simplement ses capacit√©s de filtrage du Spam et de signature DKIM, le strict minimum dont nous avons besoin.</p><div id=me-rendre-accessible class=anchor></div><h2 class="relative group">Me rendre accessible
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#me-rendre-accessible aria-label=Anchor>#</a></span></h2><p>SMTP est tr√®s √©troitement li√© avec DNS et les autres h√¥tes d√©pendent de recherches DNS pour trouver quelle machine g√®re le mail de votre domaine.
C&rsquo;est fait au-travers de la recherche d&rsquo;enregistrements MX (Mail eXchanger), donc le minimum √† faire pour que SMTP fonctionne est de d√©clarer un enregistrement MX pour votre domaine.
Pour <code>hypno.cat</code>, la zone contiendra ce qui suit :</p><pre tabindex=0><code>;; un enregistrement A (et AAAA pour IPv6) est d√©clar√© pour nommer le serveur de mail

mail.hypno.cat  A       217.69.8.253
mail.hypno.cat  AAAA    2001:19f0:6801:867:5400:01ff:fee7:7af7


;; un enregistrement MX est d√©clar√© pour dire au monde que mail.hypno.cat g√®re le
;; mail pour hypno.cat
;; 0 est la pr√©f√©rence maximale, si nous avions un serveur secondaire il aurait un
;; nombre sup√©rieur

hypno.cat.      MX 0    mail.hypno.cat.
;;hypno.cat.    MX 10   mail-backup.hypno.cat.
</code></pre><p>Je peux m&rsquo;assurer que tout est correct en utilisant <code>host</code> et <code>dig</code> pour v√©rifier que le nom r√©soud et que la recherche MX retourne bien le bon nom :</p><pre tabindex=0><code>$ host mail.hypno.cat
mail.hypno.cat has address 217.69.8.253
mail.hypno.cat has IPv6 address 2001:19f0:6801:867:5400:1ff:fee7:7af7

$ dig -t MX hypno.cat +short
0 mail.hypno.cat.
</code></pre><p>√Ä ce stade et avec ces enregistrements DNS, les autres serveurs de mail peuvent d√©j√† trouver quel serveur est responsable pour <code>hypno.cat</code>, et le contacter quand ils veulent envoyer du mail √† n&rsquo;importe quelle adresse mail de ce domaine.</p><div id=me-faire-bien-voir class=anchor></div><h2 class="relative group">Me faire bien voir
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#me-faire-bien-voir aria-label=Anchor>#</a></span></h2><p>√ätre joignable n&rsquo;est pas suffisant parce qu&rsquo;aujourd&rsquo;hui, vous <strong>DEVEZ</strong> avoir un reverse DNS (rDNS) <strong>ET</strong> un Forward-Confirmed rDNS (FCrDNS).</p><p>Il y a une raison derri√®re cela.
Un grand nombre d&rsquo;h√¥tes qui √©mettent du spam sont des machines compromises, avec une grande portion d&rsquo;entre elles qui sont des ordinateurs personnels derri√®re des connexions r√©sidentielles.
Beaucoup de ces connexions n&rsquo;ont pas de rDNS ou de FCrDNS, ou ont des rDNS qui ressemblent √† des patterns d&rsquo;IP allou√©es dynamiquement (ex. : <code>123.123.123.123.dyn.adsl.example.com</code>).</p><p>Comme il s&rsquo;agit de machines compromises individuellement, et non de machines dont la configuration est sous le contr√¥le total des spammers, les rDNS et FCrDNS ne peuvent pas √™tre configur√©s‚Ä¶
il en r√©sulte que la configuration de rDNS et FCrDNS est devenu une preuve de travail : il faut un rDNS et un FCrDNS correctement configur√© et ne ressemblant pas √† une allocation dynamique.
Chez certains Big Mailer Corps, il s&rsquo;agit de r√®gles claires, d√©crites dans les guidelines, pour d&rsquo;autres on le d√©couvre par la sanction.
Dans tous les cas, il s&rsquo;agit du <strong>STRICT MINIMUM</strong> ; assurez-vous que vos noms d&rsquo;h√¥tes ressemblent √† un <strong>VRAI</strong> nom de serveur de mail (ex. : <code>mail.hypno.cat</code>, et non pas <code>www.hypno.cat</code>).</p><p>Le rDNS est g√©n√©ralement hors de votre contr√¥le parce que dans une zone un peu sp√©ciale, <code>arpa</code>, g√©r√©e par le propri√©taire de l&rsquo;adresse IP (en g√©n√©ral votre h√©bergeur).
Les FAI ne vous laissent pas toujours les configurer ; mais les h√©bergeurs de serveurs n&rsquo;ayant pas vraiment d&rsquo;autres choix, fournissent g√©n√©ralement un formulaire quelque part sur leurs espaces clients pour assigner un rDNS aux adresses qu&rsquo;ils vous ont assign√©es :</p><center><img src=2019-09-01-vultr-rdns.png></center><p>Si je configure mon rDNS pour avoir la m√™me valeur que l&rsquo;enregistrement DNS configur√© plus haut, alors je passe automatiquement le test du FCrDNS.
On peut le v√©rifier tr√®s simplement en faisant une recherche rDNS pour l&rsquo;adresse IP :</p><pre tabindex=0><code>$ host 217.69.8.253   
253.8.69.217.in-addr.arpa domain name pointer mail.hypno.cat.
$ host 2001:19f0:6801:867:5400:1ff:fee7:7af7
7.f.a.7.7.e.e.f.f.f.1.0.0.0.4.5.7.6.8.0.1.0.8.6.0.f.9.1.1.0.0.2.ip6.arpa domain name pointer mail.hypno.cat.
</code></pre><p>Puis cherchez l&rsquo;adresse IP pour ce rDNS :</p><pre tabindex=0><code>$ host mail.hypno.cat
mail.hypno.cat has address 217.69.8.253
mail.hypno.cat has IPv6 address 2001:19f0:6801:867:5400:1ff:fee7:7af7
</code></pre><p>Si les valeurs se retrouvent dans les deux sens, tout est d&rsquo;√©querre.</p><div id=annoncer-quelles-machines-sont-autoris√©es-√†-√©mettre-pour-mon-domaine class=anchor></div><h2 class="relative group">Annoncer quelles machines sont autoris√©es √† √©mettre pour mon domaine
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#annoncer-quelles-machines-sont-autoris%c3%a9es-%c3%a0-%c3%a9mettre-pour-mon-domaine aria-label=Anchor>#</a></span></h2><p>SPF est un m√©canisme qui permet pour un domaine destination de d√©terminer si la machine qui √©met √©tait autoris√©e pour le domaine √©metteur.</p><p>Le m√©canisme est tr√®s simple, on ajoute un enregistrement DNS √† la zone de notre domaine qui d√©clare quels serveurs peuvent √©mettre.
Quand le domaine destination re√ßoit un mail avec un √©metteur de notre domaine, il v√©rifie si l&rsquo;adresse IP du serveur √©metteur en avait le droit.</p><p>SPF n&rsquo;est pas obligatoire pour SMTP mais c&rsquo;est une des choses qui nous font para√Ætre l√©gitimes face aux destinataires.
SPF est informatif par d√©faut ; ne pas passer un test SPF ou ne pas avoir d&rsquo;enregistrement SPF n&rsquo;implique pas qu&rsquo;un mail termine en Spam ou soit d√©truit.
Il est commun√©ment accept√© que l&rsquo;absence d&rsquo;un enregistrement SPF a un impact tr√®s n√©gatif sur la r√©putation d&rsquo;un domaine, c&rsquo;est m√™me explicitement dit dans les guidelines de certains Big Mailer Corps, et vu comme l&rsquo;enregistrement est simple √† fournir‚Ä¶ il n&rsquo;y a vraiment aucune excuse pour ne pas le faire.</p><p>Il y a plusieurs fa√ßons de configurer SPF ; dans cet example, je vais simplement le configurer pour n&rsquo;autoriser QUE mon serveur de mail √† envoyer du mail en mon nom :</p><pre tabindex=0><code>hypno.cat.      IN TXT  &#34;v=spf1 mx -all&#34;
</code></pre><p>Si des h√¥tes re√ßoivent un mail avec un √©metteur <code>@hypno.cat</code> qui ne provient pas de <code>mail.hypno.cat</code>, ils pourront prendre la d√©cision (ou non) de rejeter le mail.
Ils pourront en tout cas constater qu&rsquo;il provient d&rsquo;une machine qui n&rsquo;√©tait pas autoris√©e et qu&rsquo;ils ont le droit de le rejeter.</p><div id=prouver-que-jai-autoris√©-le-message-lui-m√™me class=anchor></div><h2 class="relative group">Prouver que j&rsquo;ai autoris√© le message lui m√™me.
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#prouver-que-jai-autoris%c3%a9-le-message-lui-m%c3%aame aria-label=Anchor>#</a></span></h2><p>DKIM est un m√©canisme d&rsquo;authentification par lequel on peut signer cryptographiquement les mails √©mis par notre serveur, prouvant qu&rsquo;on les a vu passer et que l&rsquo;on a pris la responsabilit√© de les laisser transiter.
Les h√¥tes qui recoivent ces mails peuvent v√©rifier qu&rsquo;ils √©taient bien autoris√©s en v√©rifiant la signature, permettant ainsi de d√©tecter des mails forg√©s hors du syst√®me de mail.</p><p>Comme SPF, c&rsquo;est informatif par d√©faut et l&rsquo;absence de signature DKIM ou une signature invalide ne veut pas dire qu&rsquo;un mail ne sera pas distribu√©.
En revanche, il est l√† aussi admis et d√©crit dans les guidelines que l&rsquo;absence de DKIM aura un effet sur la r√©putation d&rsquo;un domaine.
Et comme configurer DKIM est facile, pas vraiment d&rsquo;excuse pour ne pas le faire l√† non plus.</p><p>C&rsquo;est un petit peu plus complexe que pour SPF parce que, m√™me si √ßa d√©pend aussi de DNS, il faut g√©n√©rer une paire de cl√©s et publier la cl√© publique dans l&rsquo;enregistrement DNS.
Rien de bien foufou non plus.</p><p><strong>Nous sommes en 2019</strong>. Je vais g√©n√©rer une cl√© RSA de 1024 bits ; <strong>je sais</strong> !</p><p><strong>&mdash; BEGIN DIGRESSION &mdash;</strong></p><p>Les cl√©s RSA 2048 bits ne rentrent pas dans un enregistrement DNS TXT et doivent √™tre tronqu√©es en deux enregistrements, mais tout le monde n&rsquo;est pas capable de r√©associer ces cl√©s tronqu√©es,
et vous pouvez perdre les b√©n√©fices de DKIM si l&rsquo;h√¥te destination n&rsquo;arrive pas √† utiliser votre cl√© publique partielle et consid√®re la signature invalide.</p><p>En ce qui me concerne, ces h√¥tes sont responsables et nous pouvons les ignorer ; mais comme le but de cet article est de permettre une interop√©rabilit√© maximale et que DKIM n&rsquo;est pas pr√©sent ici pour s√©curiser quoi que ce soit, juste pour vous faire para√Ætre l√©gitime, on va juste regarder ailleurs en justifiant cette mauvaise pratique par le risque mod√©r√© de falsification de contenu quand il est utilis√© conjointement √† SPF.</p><p><strong>Ce n&rsquo;est pas une bonne mani√®re de raisonner</strong> mais DKIM a d&rsquo;autres inconv√©nients et comme virtuellement tout le monde utilise du RSA 1024-bits. Je sugg√®re de laisser le d√©bat 1024 vs >= 2048 √† plus tard, lors que nous aurons d√©j√† r√©ussis √† √©changer correctement avec les Big Mailer Corps.
Je prendrais juste le temps, sans pointer de doigt nul part, d&rsquo;appuyer sur le fait que certaines soci√©t√©s dans la s√©curit√© qui travaillent dans l&rsquo;industrie du mail ont (avaient ?) encore des probl√®mes avec les cl√©s 2048-bits en 2019.
Des soci√©t√©s qui calculent des scores de r√©putation.
Oh, la, belle, ironie !</p><p>Si c&rsquo;est un sujet d&rsquo;inqui√©tude pour vous, vous pouvez exp√©rimenter la troncature des cl√© et voir si √ßa vous convient.
Adapter mon exemple est trivial ; assurez vous juste d&rsquo;avoir la cl√© tronqu√©e sur deux enregistrements TXT.</p><p><strong>&mdash; END DIGRESSION &mdash;</strong></p><p>Je cr√©e un r√©pertoire pour contenir les cl√©s :</p><pre tabindex=0><code># mkdir /etc/mail/dkim
</code></pre><p>Ensuite, la commande suivante va g√©n√©rer une paire de cl√© et extraire la cl√© publique de la cl√© priv√©e:</p><pre tabindex=0><code># openssl genrsa -out /etc/mail/dkim/hypno.cat.key 1024                                       
Generating RSA private key, 1024 bit long modulus
‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶++++++
‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶++++++
e is 65537 (0x10001)

# openssl rsa -in /etc/mail/dkim/hypno.cat.key -pubout -out /etc/mail/dkim/hypno.cat.pub 
writing RSA key

# cat /etc/mail/dkim/hypno.cat.pub                                                                 
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDThHqiM610nwN1nmV8OMc7PaPO
uJWVGRDz5bWj4cRjTTmQYjJQd02xrydRNrRhjEKBm2mMDArNWjoM3jvN04ZifqJx
DmKr7X8jsYi+MPEHz6wZxB8mayDK6glYTCyx//zl1luUdvm26PutA38K8cgnb7iT
kfVP2OqK6sHAdXjnowIDAQAB
-----END PUBLIC KEY-----
</code></pre><p>Enfin, je g√©n√©re un enregistrement DNS TXT en retirant le blindage de la cl√© publique et en formattant le contenu pour qu&rsquo;il soit comme suit :</p><pre tabindex=0><code>20190913._domainkey.hypno.cat.	IN TXT &#34;v=DKIM1;k=rsa;p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDThHqiM610nwN1nmV8OMc7PaPOuJWVGRDz5bWj4cRjTTmQYjJQd02xrydRNrRhjEKBm2mMDArNWjoM3jvN04ZifqJxDmKr7X8jsYi+MPEHz6wZxB8mayDK6glYTCyx//zl1luUdvm26PutA38K8cgnb7iTkfVP2OqK6sHAdXjnowIDAQAB;&#34;
</code></pre><p>Le nom de l&rsquo;enregistrement est construit selon le motif : <code>&lt;selector>._domainkey.&lt;domain>.</code>, o√π <code>&lt;selector></code> est un nom arbitraire choisi pour permettre √† plusieurs cl√©s de co-exister.
J&rsquo;aime bien utiliser la date √† laquelle j&rsquo;ai g√©n√©r√© la paire de cl√©s, mais peu importe ce que vous choisissez, √©crivez le pour plus tard car nous en aurons besoin pour configurer la signature DKIM.</p><p>De plus, la cl√© publique n&rsquo;a pas besoin de rester dans le r√©pertoire une fois qu&rsquo;elle est publi√©e dans l&rsquo;enregistrement DNS.
Elle peut toujours √™tre d√©riv√©e de la cl√© priv√©e si nous en avons besoin, mais personnellement j&rsquo;aime bien la garder pour la retrouver rapidement.</p><p><strong>Faites bien attention</strong> √† ce que la cl√© priv√©e ne soit pas en lecture pour tous car, pour une raison inconnue et pas tr√®s maline, OpenSSL pense que les cl√©s priv√©es doivent √™tre cr√©√©es en <code>rw-r--r--</code>.</p><div id=dire-aux-autres-quoi-faire-en-cas-derreurs-spf-et-dkim-avec-dmarc class=anchor></div><h2 class="relative group">Dire aux autres quoi faire en cas d&rsquo;erreurs SPF et DKIM avec DMARC
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#dire-aux-autres-quoi-faire-en-cas-derreurs-spf-et-dkim-avec-dmarc aria-label=Anchor>#</a></span></h2><p>SPF et DKIM sont tous les deux tr√®s int√©ressants, mais ils ne sont qu&rsquo;informatifs, alors ils n&rsquo;emp√™chent pas d&rsquo;abuser de votre nom de domaine.</p><p>DMARC permet de dire aux serveurs mails de destination ce que vous voulez qu&rsquo;ils fassent des mails en apparence de votre domaine qui ratent les tests SPF et DKIM.
Il permet par exemple de leur dire qu&rsquo;ils doivent rejeter ces mails.</p><p>Il n&rsquo;y a pas d&rsquo;indicateur clair : fournir une politique de rejet nous fait mieux voir que de fournir une politique sans action. Des exp√©rimentations semblent montrer qu&rsquo;avoir un enregistrement a un impact positif par rapport √† n&rsquo;en avoir aucun, m√™me si l&rsquo;enregistrement dit que rien ne doit √™tre fait avec les erreurs SPF et DKIM.
Il serait int√©ressant de mener une nouvelle exp√©rimentation √† ce sujet, mais en m√™me temps, il est plus simple de fournir une politique de rejet et de ne pas avoir √† se poser la question :-)</p><p>Le format d&rsquo;un enregistrement DMARC va bien au-del√† de cet article et vous trouverez de nombreux exemples dans n&rsquo;importe quel moteur de cherche. Un enregistrement simple annoncera une politique (p=) de <code>none</code> (<code>reject</code> si vous voulez rejeter, <code>quarantine</code> si vous avez besoin de temps pour d√©cider).
Le champ pourcentage (pct=) d√©clare combien de ces mails devraient √™tre sujets √† la politique DMARC, et le champ Reporting URI of Aggregates (rua=) est la destination des rapports DMARC (pour analyse avant de basculer de <code>quarantine</code> √† <code>reject</code> par exemple).</p><p>Je vais ici cr√©er un enregistrement simple, un enregistrement qui fera que les Big Mailer Corps voient que nous nous int√©ressons √† DMARC m√™me si nous ne savons pas encore quoi en faire :</p><pre tabindex=0><code>_dmarc.hypno.cat.   IN TXT    &#34;v=DMARC1;p=none;pct=100;rua=mailto:postmaster@hypno.cat;&#34;
</code></pre><p>Mon opinion est qu&rsquo;il est pr√©f√©rable de basculer rapidement vers <code>p=reject</code>, apr√®s s&rsquo;√™tre assur√© que les mails sont correctement sign√©s et que seul notre serveur de mail les √©met.</p><div id=obtenir-un-certificat-pour-tls class=anchor></div><h2 class="relative group">Obtenir un certificat pour TLS
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#obtenir-un-certificat-pour-tls aria-label=Anchor>#</a></span></h2><p>Il y a plusieurs fa√ßons d&rsquo;obtenir un certificat TLS.
Je vais partir du principe que vous √™tes familiers avec l&rsquo;h√©bergement d&rsquo;autres services et que vous √™tes capable d&rsquo;en obtenir un par votre registrar ou depuis <a href=https://letsencrypt.org target=_blank>letsencrypt</a>.
Si ce n&rsquo;est pas le cas, vous trouverez des exemples √† foison sur n&rsquo;importe quel moteur de recherche.</p><p><strong>Si vous savez g√©rer vos certificats, vous pouvez sauter √† la section suivante.</strong></p><p>Comme je suis r√©ellement en train de mettre en place <code>mail.hypno.cat</code>, je ne serais pas en mesure de continuer cet article sans obtenir de certificat, donc en bonus pour les utilisateurs d&rsquo;OpenBSD, je vais documenter la g√©n√©ration de mon certificat sur ma nouvelle installation.</p><p><code>acme-client</code> est un utilitaire pr√©sent dans le syst√®me de base et qui permet de demander ou renouveller des certificats depuis la console.
Il d√©pend d&rsquo;un challenge HTTP ; il doit donc √™tre en mesure d&rsquo;√©crire dans un r√©pertoire qui soit accessible par HTTP.
Et comme nous sommes chanceux‚Ä¶
OpenBSD contient un serveur <code>httpd</code> que l&rsquo;on peut utiliser pour ce challenge.
Et comme nous sommmes <strong>TR√àS</strong> chanceux‚Ä¶
OpenBSD fournit aussi un exemple de fichier de configuration que l&rsquo;on peut utiliser sans gros changement.</p><p>On copie simplement le fichier d&rsquo;example depuis <code>/etc/example/httpd.conf</code> vers <code>/etc/httpd.conf</code>, en rempla√ßant <code>example.com</code> par <code>mail.hypno.cat</code> et en supprimant le bloc TLS puisque seul le challenge nous interesse.
Le fichier doit ressembler √† cela :</p><pre tabindex=0><code>server &#34;mail.hypno.cat&#34; {
        listen on * port 80
        location &#34;/.well-known/acme-challenge/*&#34; {
                root &#34;/acme&#34;
                request strip 2
        }
        location * {
                block return 302 &#34;https://$HTTP_HOST$REQUEST_URI&#34;
        }
}
</code></pre><p>Le daemon <code>httpd</code> peut √™tre d√©marr√© comme suit :</p><pre tabindex=0><code># rcctl -f start httpd
httpd(ok)
</code></pre><p>En ce qui concerne <code>acme-client</code>, c&rsquo;est tr√®s simple, on copie √† nouveau le fichier d&rsquo;exemple depuis <code>/etc/example/acme-client.conf</code> vers <code>/etc/acme-client.conf</code>,
en rempla√ßant <code>example.com</code> par <code>mail.hypno.cat</code> et on doit se retrouver avec un bloc comme suit :</p><pre tabindex=0><code>domain mail.hypno.cat {
        domain key &#34;/etc/ssl/private/mail.hypno.cat.key&#34;
        domain full chain certificate &#34;/etc/ssl/mail.hypno.cat.fullchain.pem&#34;
        sign with letsencrypt
}
</code></pre><p>√Ä ce stade, on se contente de lancer <code>acme-client</code> pour notre domaine :</p><pre tabindex=0><code># acme-client -v mail.hypno.cat
[‚Ä¶]
acme-client: /etc/ssl/mail.hypno.cat.fullchain.pem: created
</code></pre><p>Le certificat et les cl√©s sont cr√©√©s au bon endroit, il suffira par la suite d&rsquo;ajouter les chemins dans OpenSMTPD et Dovecot.</p><p>Vous pouvez garder <code>httpd</code> en marche pour les renouvellements et appeller <code>acme-client</code> depuis un cron, vous pouvez l&rsquo;√©teindre et renouveller d&rsquo;une autre fa√ßon.
Je vous laisse vous d√©brouiller ; vous trouverez comment faire avec l&rsquo;aide de la page de manuel <code>acme-client(1)</code>.</p><div id=installer-et-configurer-rspamd class=anchor></div><h2 class="relative group">Installer et configurer Rspamd
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#installer-et-configurer-rspamd aria-label=Anchor>#</a></span></h2><p>Sur OpenBSD, Rspamd est packag√© et peut √™tre install√© d&rsquo;une simple commande.
Nous avons aussi besoin d&rsquo;installer Redis qui sert √† stocker des statistiques pour Rspamd et son greylisting (entre autres), et √©galement <code>filter-rspamd</code> qui est un petit bout de code qui permets √† OpenSMTPD de travailler avec Rspamd.
Ils existent √©galement sous forme de packages et peuvent √™tre install√©s en une seule commande.</p><p>Tout d&rsquo;abord, on installe les packages :</p><pre tabindex=0><code>mail$ doas pkg_add redis rspamd opensmtpd-filter-rspamd
[‚Ä¶]
redis-4.0.14: ok
rspamd-1.9.0: ok
opensmtpd-filter-rspamd-0.1.1: ok
The following new rcscripts were installed: /etc/rc.d/redis /etc/rc.d/rspamd
See rcctl(8) for details.
</code></pre><p>Rspamd est tr√®s configurable, si vous voulez faire des choses un peu funky je vous laisse <a href=https://rspamd.com/doc/configuration/ target=_blank>lire la documentation</a>.
Pour cet article je me contenterai d&rsquo;une utilisation tr√®s basique, comme c&rsquo;est le cas sur mes propres machines :</p><p>Je pourrais √©diter la configuration dans <code>/etc/rspamd/actions.conf</code> pour ajuster les seuils de mise en spam, mais les valeurs par d√©faut me conviennent alors je vous les montre juste :</p><pre tabindex=0><code>actions {
    reject = 15;    # Reject when reaching this score
    add_header = 6; # Add header when reaching this score
    greylist = 4;   # Apply greylisting when reaching this score (will emit `soft reject action`)
    [‚Ä¶]
</code></pre><p>Mais ce que <strong>je veux vraiment</strong> c&rsquo;est que Rspamd g√®re la signature DKIM parce que c&rsquo;est un des pr√©-requis pour para√Ætre l√©gitime.</p><p>On le fait en fournissant une configuration dans <code>/etc/rspamd/local.d/dkim_signing.conf</code> pour faire correspondre √† notre domaine la cl√© DKIM g√©n√©r√©e plus t√¥t :</p><pre tabindex=0><code># mkdir /etc/rspamd/local.d
# cat &lt;&lt; EOF &gt;/etc/rspamd/local.d/dkim_signing.conf
allow_username_mismatch = true;

domain {
    hypno.cat {
        path = &#34;/etc/mail/dkim/hypno.cat.key&#34;;
        selector = &#34;20190913&#34;;
    }
}
EOF
</code></pre><p>La cl√© de configuration <code>allow_username_mismatch</code> est n√©cessaire parce que Rspamd attend des utilisateurs avec des noms de domaines, mais <strong>dans cette configuration</strong> OpenSMTPD authentifie de simples utilisateurs syst√®me.
De plus, faites attention √† ce que le fichier contenant la cl√© DKIM soit autoris√© en lecture au groupe <code>_rspamd</code>.</p><p>√Ä ce stade on est bon, Rspamd et Redis peuvent √™tre activ√©s pour qu&rsquo;OpenBSD les d√©marre √† chaque reboot :</p><pre tabindex=0><code># rcctl enable redis
# rcctl enable rspamd
</code></pre><p>Et on peut les d√©marrer imm√©diatement pour ne pas avoir √† attendre le prochain reboot :</p><pre tabindex=0><code># rcctl start redis
redis(ok)
# rcctl start rspamd
rspamd(ok)
</code></pre><div id=configurer-opensmtpd class=anchor></div><h2 class="relative group">Configurer OpenSMTPD
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#configurer-opensmtpd aria-label=Anchor>#</a></span></h2><p>OpenSMTPD est install√© par d√©faut sur OpenBSD donc aucune phase d&rsquo;installation ici.
Si vous utilisez un syst√®me d&rsquo;exploitation diff√©rent, soit quelqu&rsquo;un l&rsquo;a packag√© et vous pouvez l&rsquo;installer avec votre gestionnaire de paquets, ou vous pouvez le construire depuis les sources et l&rsquo;installer en utilisant le code depuis le <a href=https://github.com/OpenSMTPD/OpenSMTPD target=_blank>mirroir Github</a> et en suivant les instructions de build.</p><p>Comme √©crit plus haut, <strong>ces instructions ne sont valides que pour la version 6.6.0 et ult√©rieures</strong>, les versions pr√©c√©dentes ne supportent pas les filtres et certaines des fonctionnalit√©s d√©crites ici.</p><p>La configuration par d√©fault d&rsquo;OpenSMTPD est adapt√©e √† un serveur de mail local, n&rsquo;acceptant pas de connexions de l&rsquo;ext√©rieur, mais capable de laisser les utilisateurs locaux s&rsquo;√©changer des messages et en √©mettre vers des h√¥tes distants.</p><p>Elle ressemble √† ce qui suit :</p><pre tabindex=0><code>#       $OpenBSD: smtpd.conf,v 1.11 2018/06/04 21:10:58 jmc Exp $

# This is the smtpd server system-wide configuration file.
# See smtpd.conf(5) for more information.

table aliases file:/etc/mail/aliases

# To accept external mail, replace with: listen on all
#
listen on lo0

action &#34;local_mail&#34; mbox alias &lt;aliases&gt;
action &#34;outbound&#34; relay

# Uncomment the following to accept external mail for domain &#34;example.org&#34;
#
# match from any for domain &#34;example.org&#34; action &#34;local_mail&#34;
match from local for local action &#34;local_mail&#34;
match from local for any action &#34;outbound&#34;
</code></pre><p>Je voulais initialement mettre √† jour la configuration progressivement pour vous tenir par la main, mais cet article √† √©norm√©ment grossi depuis sa premi√®re version.
Par souci de simplicit√©, je vais simplement mettre les 16 lignes de configuration et les commenter ensuite :</p><pre tabindex=0><code>pki mail.hypno.cat cert &#34;/etc/ssl/mail.hypno.cat.fullchain.pem&#34;
pki mail.hypno.cat key &#34;/etc/ssl/private/mail.hypno.cat.key&#34;

filter check_dyndns phase connect match rdns regex { &#39;.*\.dyn\..*&#39;, &#39;.*\.dsl\..*&#39; } \
    disconnect &#34;550 no residential connections&#34;

filter check_rdns phase connect match !rdns \
    disconnect &#34;550 no rDNS is so 80s&#34;

filter check_fcrdns phase connect match !fcrdns \
    disconnect &#34;550 no FCrDNS is so 80s&#34;

filter senderscore \
    proc-exec &#34;filter-senderscore -blockBelow 10 -junkBelow 70 -slowFactor 5000&#34;

filter rspamd proc-exec &#34;filter-rspamd&#34;

table aliases file:/etc/mail/aliases

listen on all tls pki mail.hypno.cat \
    filter { check_dyndns, check_rdns, check_fcrdns, senderscore, rspamd }

listen on all port submission tls-require pki mail.hypno.cat auth filter rspamd

action &#34;local_mail&#34; maildir junk alias &lt;aliases&gt;
action &#34;outbound&#34; relay helo mail.hypno.cat

match from any for domain &#34;hypno.cat&#34; action &#34;local_mail&#34;
match from local for local action &#34;local_mail&#34;

match from any auth for any action &#34;outbound&#34;
match from local for any action &#34;outbound&#34;
</code></pre><p>C&rsquo;est tout ce dont nous avons besoin pour notre configuration SMTP compl√®te.</p><p>Les deux premi√®res lignes <code>pki</code> d√©clarent que <code>mail.hypno.cat</code> utilisera le certificat et la cl√© que nous avons g√©n√©r√©s plus t√¥t pour TLS.</p><p>Les lignes <code>filter</code> appliquent un ensemble de filtres sur les connexions entrantes. <code>check_dyndns</code> filtrera si rDNS corresponds √† certains motifs. <code>check_rdns</code> filtrera s&rsquo;il n&rsquo;y a pas de rDNS.
<code>check_fcrdns</code> filtrera si la correspondance FCrDNS √©choue.
Il s&rsquo;agit de filtres &ldquo;internes&rdquo; √† OpenSMTPD que vous pouvez ajuster pour filtrer diff√©rement, √† d&rsquo;autres phases ou avec d&rsquo;autres crit√®res.</p><p><code>senderscore</code> est un filtre custom que vous pouvez installer soit depuis votre gestionnaire de paquets (<code>pkg_add opensmtpd-filter-senderscore</code> sur OpenBSD), ou obtenir depuis <a href=https://github.com/poolpOrg/filter-senderscore target=_blank>Github</a>.
Il n&rsquo;est pas obligatoire mais je le trouve particuli√®rement utile et expliquerai pourquoi dans la prochaine section.
Dans cette configuration, il rejettera un √©metteur si son senderscore est en dessous de 10, il <code>junk</code>-era le message (ajoutera un ent√™te <code>X-Spam</code> si le score est inf√©rieur √† 70), et pour mon plaisir personnel, ajoutera avant chaque r√©ponse un d√©lai inversement proportionnel √† la r√©putation de l&rsquo;√©metteur pour ralentir les mauvais √©metteurs.</p><p><code>rspamd</code> est √©galement un filtre custom que nous avons install√© dans la pr√©cedente section.
Il n&rsquo;y a aucune configuration car il est enti√®rement control√© depuis Rspamd, il suffit donc de le d√©clarer.</p><p>Si vous voulez √™tre plus conservateur et ne pas rejeter les mail pour √©viter des faux positifs, vous pouvez assigner l&rsquo;action <code>junk</code> plut√¥t que <code>disconnect</code> aux filtres internes et supprimer l&rsquo;option <code>-blockBelow</code> au filtre <code>senderscore</code> :</p><pre tabindex=0><code>filter check_dyndns phase connect match rdns regex { &#39;.*\.dyn\..*&#39;, &#39;.*\.dsl\..*&#39; } junk
filter check_rdns phase connect match !rdns junk
filter check_fcrdns phase connect match !fcrdns junk
filter senderscore proc-exec &#34;filter-senderscore -junkBelow 70 -slowFactor 5000&#34;
</code></pre><p>De cette fa√ßon, au lieu de rejeter les sessions, OpenSMTPD va simplement junk les messages pour les faire atterrir en boite √† Spam.
En regardant r√©guli√®rement ce qui atterri dans cette boite, vous pourrez gagner en confiance et adapter vos r√©glages pour trouver ceux qui vous conviennent.</p><p>Ces filtres simples, sans m√™me compter <code>rspamd</code>, sont suffisants pour tuer la plus grosse partie du spam.
Chez moi, ils permettent de passer de <em>plusieurs centaines</em> de spam quotidiens √† une poign√©e.
Le filtre <code>rdns regex</code> doit √™tre adapt√© en fonction du pays, vous pouvez trouver des motifs qui sont r√©currents chez vous et n&rsquo;apparaissent jamais chez moi.
Pour faciliter la maintenance, ils peuvent √™tre stock√©s dans un fichier √† raison d&rsquo;un par ligne, en respectant la construction suivante :</p><pre tabindex=0><code>table &lt;dyndns&gt; file:/etc/mail/path-to-my-regex-file
filter check_dyndns phase connect match rdns regex &lt;dyndns&gt; junk
</code></pre><p>Continuons √† diss√©quer la configuration.</p><p>La table <code>aliases</code> pointe vers un fichier d&rsquo;alias sur deux colonnes.
La colonne de gauche correspond √† la partie utilisateur d&rsquo;une adresse e-mail que vous recevez ; la colonne de droite correspond √† l&rsquo;utilisateur √† qui le mail doit √™tre livr√© (ex. : <code>root: gilles</code>).
Il est recommand√© d&rsquo;aliaser les adresses <code>root</code>, <code>abuse</code> et <code>postmaster</code> vers une adresse que vous lisez r√©ellement.
Je ne le fais pas ici parce que je vais simplement d√©truire le setup une fois l&rsquo;article fini, mais en ce qui vous concerne, faites le !</p><p>Ensuite viennent les lignes <code>listen</code>.
La premi√®re est le point d&rsquo;attache que vont contacter les autres serveurs de mail qui souhaitent envoyer du mail vers <code>hypno.cat</code>. Elle est configur√©e pour offrir <code>tls</code> en utilisant les certificats et cl√©s pour <code>mail.hypno.cat</code> et pour filtrer les sessions entrantes avec mes filtres.
La seconde est le point d&rsquo;attache que vont contacter mes propres utilisateurs sur le port de <code>submission</code>, qui requiert TLS en utilisant les m√™mes certificats et cl√©s, mais √©galement l&rsquo;authentification des utilisateurs syst√®me locaux (le d√©faut peut √™tre chang√©), et filtrant √†-travers le filtre rspamd uniquement dans le but de faire la signature DKIM de nos messages.</p><p>Les lignes <code>action</code> d√©finissent les actions √† entreprendre avec les mails qui sont accept√©s dans le syst√®me.
Une action locale permet de distribuer dans une maildir, en classifiant les spams dans un r√©pertoire sp√©cifique, et en r√©solvant les alias.
Une seconde action permets de relayer les mails en s&rsquo;annon√ßant en tant que <code>mail.hypno.cat</code> aux autres h√¥tes.
Si le serveur disposait de plusieurs adresses IP, il serait possible d&rsquo;assigner √† l&rsquo;aide de l&rsquo;option <code>src</code> celle √† utiliser, mais ici je n&rsquo;ai qu&rsquo;une seule adresse IP donc pas besoin de la sp√©cifier.</p><p>Enfin, les lignes <code>match</code> repr√©sentent l&rsquo;ensemble des r√®gles.
Quand une enveloppe entre dans le serveur SMTP au travers d&rsquo;un des points d&rsquo;attache <code>listen</code>, elle est compar√©e s√©quentiellement √† chaque ligne <code>match</code> jusqu&rsquo;√† trouver une correspondance ou rejet√©e si aucune correspondance n&rsquo;est trouv√©e.
Lorsqu&rsquo;une correspondance est trouv√©e, l&rsquo;action associ√©e √† la r√®gle est prise en compte.
Les r√®gles de match sont tr√®s simples √† comprendre, je ne vais donc pas les expliquer ; vous devriez arriver √† comprendre seuls ce que signifie <code>from any for domain "hypno.cat"</code>, sans quoi vous ne devriez pas lire cet article en premier lieu.</p><div id=quelques-mots-au-sujet-de-senderscore class=anchor></div><h2 class="relative group">Quelques mots au sujet de SenderScore
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#quelques-mots-au-sujet-de-senderscore aria-label=Anchor>#</a></span></h2><p>SenderScore est une base de donn√©e de r√©putation IP qui associe un score entre 0 et 100 √† une adresse IP.
Le score est li√© au volume et comportement observ√© depuis ces adresses IP, et m√™me si l&rsquo;on ne sait pas COMMENT sont calcul√©s ces scores parce que la m√©thodologie n&rsquo;est pas publique,
un peu d&rsquo;√©tude permet de confirmer que ces nombres ne sortent pas de nul part : ils sont corr√©l√©s au ratio de distribution et d&rsquo;erreur chez diff√©rents Big Mailer Corps et il est possible d&rsquo;influencer le score en changeant de comportement.</p><p>Il est √©galement <strong>TR√àS</strong> clair que pour construire les scores de r√©putation, ils ont acc√®s √† des informations relatives aux sessions SMTP dont seuls les serveurs mails de destinations peuvent disposer, comme le volume de mails ou le ratio de destinataires accept√©s et refus√©s, observ√©s depuis une adresse, impliquant que ces informations sont obtenues directement depuis les Big Mailer Corps.
Faites ce que vous voulez de cela.</p><p>En me basant sur <strong><em>MA</em></strong> compr√©hension, il s&rsquo;agit d&rsquo;un indicateur int√©ressant pour limiter la quantit√© de spam qui vous atteint.
Je ne fait pas confiance √† cet indicateur concernant les bons scores (parce que je sais √† peu pr√®s contourner) mais j&rsquo;y fais √âNORM√âMENT confiance en ce qui concerne les mauvais scores, parce qu&rsquo;il faut vraiment faire un paquet de mauvaises choses en gros volume pour que le score se d√©grade.
Si vous ne faites pas de mailing en masse, vous √™tes cens√©s √™tre soit inconnu de cette base de donn√©e ou avoir un score sup√©rieur √† 95, sinon il y a quelque chose qui d√©conne chez vous.</p><p>Tout le monde n&rsquo;est pas convaincu par SenderScore et certains experts en d√©liverabilit√© disent que c&rsquo;est du pipeau.
J&rsquo;ai personnellement fait tourner une exp√©rimentation sur plusieurs mois en graphant volume et r√©putation quotidienne, en comparant aux graphs de distribution. Mon opinion est contraire :
il y a une correlation tr√®s significative qui permet clairement de classifier les √©metteurs.
Je pense que la meilleure approche est d&rsquo;utiliser le filtre pour junker, et non bloquer, pour d√©terminer par vous m√™me si vous en √™tes satisfait.</p><p>SenderScore consid√®re que les √©metteurs devraient avoir une r√©putation sup√©rieure √† 70. Je pense pour ma part que les h√¥tes avec un score inf√©rieur √† 70 sont de bons candidats au junk, les h√¥tes avec un score inf√©rieur √† 10 sont des rejets √©vidents.</p><div id=installer-et-configurer-dovecot class=anchor></div><h2 class="relative group">Installer et configurer Dovecot
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#installer-et-configurer-dovecot aria-label=Anchor>#</a></span></h2><p>OpenBSD dispose d&rsquo;un paquet pour Dovecot qui peut √™tre install√© d&rsquo;une simple commande :</p><pre tabindex=0><code>mail# pkg_add dovecot
dovecot-2.3.7.2v0: ok
The following new rcscripts were installed: /etc/rc.d/dovecot
See rcctl(8) for details.
New and changed readme(s):
        /usr/local/share/doc/pkg-readmes/dovecot
[‚Ä¶]
</code></pre><p>Et, <strong>specifiquement pour OpenBSD</strong>, en suivant les instructions du fichier readme, le fichier <code>/etc/login.conf</code> devrait contenir une classe <code>dovecot</code> pour augmenter les ressources autoris√©es √† Dovecot, gourmand en descripteurs de fichiers :</p><pre tabindex=0><code>dovecot:\
    :openfiles-cur=1024:\
    :openfiles-max=2048:\
    :tc=daemon:
</code></pre><p>Cela fait, il n&rsquo;y a plus grand chose √† faire √† part pointer Dovecot sur le certificat et la cl√© TLS g√©n√©r√©s plus t√¥t.
On le fait en modifiant les cl√©s de configuration <code>ssl_cert</code> et <code>ssl_key</code> dans le fichier <code>/etc/dovecot/conf.d/10-ssl.conf</code> pour qu&rsquo;elles soient comme suit :</p><pre tabindex=0><code>ssl_cert = &lt;/etc/ssl/mail.hypno.cat.fullchain.pem
ssl_key = &lt;/etc/ssl/private/mail.hypno.cat.key
</code></pre><p>Puis dire √† Dovecot que les mails sont livr√©s dans le r√©pertoire <code>~/Maildir</code> de chaque utilisateur puisque c&rsquo;est l√† que OpenSMTPD les d√©posera.
On le fait en modifiant la cl√© de configuration <code>mail_location</code> dans le fichier <code>/etc/dovecot/conf.d/10-mail.conf</code> pour qu&rsquo;elle soit comme suit :</p><pre tabindex=0><code>mail_location = maildir:~/Maildir
</code></pre><p>On est bon.</p><p>Le daemon peut √™tre activ√© pour √™tre d√©marr√© √† chaque reboot, puis d√©marr√© imm√©diatement :</p><pre tabindex=0><code>mail# rcctl enable dovecot
mail# rcctl start dovecot   
dovecot(ok)
</code></pre><p>√Ä ce stade, il est possible de configurer n&rsquo;importe quel client mail comme <code>mutt</code>, <code>thunderbird</code> ou m√™me l&rsquo;application <code>gmail</code> sur Android, et utiliser <code>mail.hypno.cat</code> pour les mails entrants et sortants.</p><center><img src=2019-09-01-smartphone.png></center><div id=apprendre-√†-dovecot-√†-entrainer-rspamd class=anchor></div><h2 class="relative group">Apprendre √† Dovecot √† entrainer Rspamd
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#apprendre-%c3%a0-dovecot-%c3%a0-entrainer-rspamd aria-label=Anchor>#</a></span></h2><p>Vous avez lu jusqu&rsquo;ici ? bien.</p><p>Cette section est une section bonus, elle n&rsquo;est absolument pas n√©cessaire pour configurer votre serveur de mail, mais c&rsquo;est un √©l√©ment que j&rsquo;aime ajouter parce qu&rsquo;il permet aux utilisateurs d&rsquo;entrainer le filtre antispam d&rsquo;une mani√®re √† laquelle ils sont habitu√©s :
en d√©pla√ßant un mail vers la boite √† Spam, ou en appuyant sur un bouton &ldquo;signaler un Spam&rdquo;, &ldquo;marquer comme Spam&rdquo; ou peu importe comment il s&rsquo;appelle dans l&rsquo;interface utilis√©e. Le bon c√¥t√© est que cet √©l√©ment de configuration s&rsquo;int√®gre avec IMAP, donc peu importe comment les mails sont consult√©s et depuis quel logiciel, l&rsquo;action de marquer un mail comme Spam entra√Ænera automatiquement le filtre.</p><p>C&rsquo;est tr√®s simple en th√©orie : il suffit de brancher deux scripts, l&rsquo;un qui g√®re le d√©placement dans la boite √† Spam, l&rsquo;autre qui g√®re le d√©placement hors de la boite √† Spam.
Les Big Mailer Corps utilisent des strat√©gies plus pouss√©es en d√©tectant les mails non ouverts, ceux d√©plac√©s directement en poubelle, etc‚Ä¶
mais d√©butons simple, il est toujours possible d&rsquo;√©tendre ensuite.</p><p>Pour faire ce branchement, nous d√©pendont de Sieve qui est‚Ä¶
comment dire avec diplomatie‚Ä¶
un peu sur-con√ßu.</p><p><strong>Ce n&rsquo;est pas un √©l√©ment critique du setup, vous √™tes autoris√©s √† √©teindre vos cerveaux et suivre les instructions aveugl√©ment.</strong>
<strong>Le pire qui puisse arriver ici est que l&rsquo;entra√Ænement de la d√©tection ne marche pas.</strong></p><p>Pour activer imap sieve, le package Pigeonhole doit √™tre install√©, encore une fois √† l&rsquo;aide d&rsquo;une simple commande :</p><pre tabindex=0><code>mail# pkg_add dovecot-pigeonhole
dovecot-pigeonhole-0.5.7.2v1: ok

[‚Ä¶]
</code></pre><p>Et‚Ä¶ voici la partie la plus complexe, il faut configurer Dovecot pour activer <code>imap_sieve</code> et lui apprendre quels scripts utiliser pour quelles actions.</p><p>D&rsquo;abord, on active <code>imap_sieve</code> dans Dovecot en l&rsquo;ajoutant dans la liste des plugins mails pour IMAP.
C&rsquo;est fait en mofifiant la cl√© de configuration <code>mail_plugins</code> dans le fichier <code>/etc/dovecot/conf.d/20-imap.conf</code> :</p><pre tabindex=0><code>protocol imap {
    [‚Ä¶]

    mail_plugins = $mail_plugins imap_sieve
 
    [‚Ä¶]
}
</code></pre><p>Ensuite pour apprendre √† Dovecot √† entrainer Rspamd, on ajoute la section suivante dans le fichier <code>/etc/dovecot/conf.d/90-plugin.conf</code>, pour dire quel script sieve d√©clencher quand un mail est d√©plac√© vers ou hors du r√©pertoire Junk :</p><pre tabindex=0><code>plugin {
  sieve_plugins = sieve_imapsieve sieve_extprograms
  sieve_global_extensions = +vnd.dovecot.pipe +vnd.dovecot.environment

  imapsieve_mailbox1_name = Junk
  imapsieve_mailbox1_causes = COPY APPEND
  imapsieve_mailbox1_before = file:/usr/local/lib/dovecot/sieve/report-spam.sieve

  imapsieve_mailbox2_name = *
  imapsieve_mailbox2_from = Junk
  imapsieve_mailbox2_causes = COPY
  imapsieve_mailbox2_before = file:/usr/local/lib/dovecot/sieve/report-ham.sieve

  imapsieve_mailbox3_name = Inbox
  imapsieve_mailbox3_causes = APPEND
  imapsieve_mailbox3_before = file:/usr/local/lib/dovecot/sieve/report-ham.sieve

  sieve_pipe_bin_dir = /usr/local/lib/dovecot/sieve
}
</code></pre><p>Maintenant que Dovecot est pr√™t, on pr√©pare la partie Sieve qui d√©pend de deux scripts pour entra√Æner le Spam et le Ham dans <code>/usr/local/lib/dovecot/sieve</code> :</p><pre tabindex=0><code># cat report-ham.sieve

require [&#34;vnd.dovecot.pipe&#34;, &#34;copy&#34;, &#34;imapsieve&#34;, &#34;environment&#34;, &#34;variables&#34;];

if environment :matches &#34;imap.mailbox&#34; &#34;*&#34; {
  set &#34;mailbox&#34; &#34;${1}&#34;;
}

if string &#34;${mailbox}&#34; &#34;Trash&#34; {
  stop;
}

if environment :matches &#34;imap.user&#34; &#34;*&#34; {
  set &#34;username&#34; &#34;${1}&#34;;
}

pipe :copy &#34;sa-learn-ham.sh&#34; [ &#34;${username}&#34; ];
</code></pre><pre tabindex=0><code># cat report-spam.sieve

require [&#34;vnd.dovecot.pipe&#34;, &#34;copy&#34;, &#34;imapsieve&#34;, &#34;environment&#34;, &#34;variables&#34;];

if environment :matches &#34;imap.user&#34; &#34;*&#34; {
  set &#34;username&#34; &#34;${1}&#34;;
}

pipe :copy &#34;sa-learn-spam.sh&#34; [ &#34;${username}&#34; ];
</code></pre><p>Et parce que les deux scripts Sieve d√©pendent de scripts shell <code>sa-learn-ham.sh</code> et <code>sa-learn-spam.sh</code>, on cr√©e aussi ces deux scripts shell dans <code>/usr/local/lib/dovecot/sieve</code> :</p><pre tabindex=0><code># cat sa-learn-ham.sh

#!/bin/sh
exec /usr/local/bin/rspamc -d &#34;${1}&#34; learn_ham
</code></pre><pre tabindex=0><code># cat sa-learn-spam.sh

#!/bin/sh
exec /usr/local/bin/rspamc -d &#34;${1}&#34; learn_spam
</code></pre><p>Enfin, on compile les scripts Sieve et on rend les scripts shell ex√©cutables pour que Dovecot puisse les utiliser :</p><pre tabindex=0><code># sievec report-ham.sieve
# sievec report-spam.sieve
# chmod 755 sa-learn-ham.sh
# chmod 755 sa-learn-spam.sh
</code></pre><p>C&rsquo;est tout. Dor√©navant en d√©pla√ßant un mail d&rsquo;un r√©pertoire √† un autre, on doit voir les lignes suivantes dans le fichier de log <code>/var/log/rspamd/rspamd.log</code> :</p><pre tabindex=0><code>2019-09-13 23:59:46 #18598(controller) &lt;1d44bd&gt;; csession; rspamd_controller_learn_fin_task: &lt;127.0.0.1&gt; learned message as ham: CAHPtQbOxQxBCsVd7nUCP4podu74Pa-F6k28z+4BWfNeeqWYiAg@mail.gmail.com
[‚Ä¶]
2019-09-14 00:01:57 #18598(controller) &lt;b76e28&gt;; csession; rspamd_controller_learn_fin_task: &lt;127.0.0.1&gt; learned message as spam: CAHPtQbOxQxBCsVd7nUCP4podu74Pa-F6k28z+4BWfNeeqWYiAg@mail.gmail.com
[‚Ä¶]
</code></pre><p>Il est surement possible de simplifier, je vais √™tre honn√™te et dire que mon int√©r√™t pour Sieve n&rsquo;est pas assez pouss√© pour que je me perfectionne.
C&rsquo;est une fonctionnalit√© sur le c√¥t√© et je ne toucherai probablement pas les scripts avant les dix prochaines ann√©es.
Je ne suis pas du tout convaincu par Sieve et quand j&rsquo;aurai le temps, je ferais une alternative qui ne me rappelle pas les ann√©es m4 de Sendmail.</p><div id=tester-le-tout class=anchor></div><h2 class="relative group">Tester le tout
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#tester-le-tout aria-label=Anchor>#</a></span></h2><p>Et maintenant, on va juste tester que l&rsquo;on arrive √† faire un trajet complet aller-retour de mail depuis <code>hypno.cat</code> vers <code>gmail.com</code>.</p><p>Tout d&rsquo;abord, je pr√©pare un mail depuis mon compte <code>hypno.cat</code> vers mon compte <code>gmail.com</code> :</p><center><img src=2019-09-01-craft-mail.png></center><p>Apr√®s envoi, je v√©rifie qu&rsquo;il arrive bien chez <code>gmail.com</code> :</p><center><img src=2019-09-01-gmail-1.png></center><p>Ensuite, je v√©rifie que l&rsquo;√©mission a bien eu lieu par dessus un canal s√©curis√© par TLS :</p><center><img src=2019-09-01-gmail-2.png></center><p>Je v√©rifie √©galement que <code>gmail.com</code> est content avec notre d√©claration SPF, notre signature DKIM et qu&rsquo;il a bien vu notre enregistrement DMARC.
On fait cela en s√©lectionnant &ldquo;Voir l&rsquo;original&rdquo; dans le menu associ√© √† chaque mail :</p><center><img src=2019-09-01-gmail-3.png></center><p>Enfin, j&rsquo;y r√©pond pour √™tre sur que √ßa fonctionne dans les deux sens :</p><center><img src=2019-09-01-received-mail.png></center><div id=cool-on-a-fini class=anchor></div><h2 class="relative group">Cool, on a fini
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cool-on-a-fini aria-label=Anchor>#</a></span></h2><p>Cet article est dense, je voulais <em>expliquer</em> pourquoi on fait les choses. Si vous retirez toutes les explications et gardez juste les d√©tails purement techniques, vous r√©aliserez que nous avons construit une infrastructure de mail, fournissant des services entrants et sortants s√©curis√©s par TLS, avec un trafic sortant respectant DKIM, SPF et DMARC, et un trafic entrant filtrant le spam.</p><p>On a fait cela en :</p><ul><li>ajoutant deux enregistrements A, un MX et trois TXT dans notre zone DNS;</li><li>faisant attention √† avoir un rDNS correctement configur√©</li><li>installant un certificat TLS</li><li>pr√©parant un fichier de configuration d&rsquo;environ 15 lignes pour un serveur SMTP</li><li>modifiant 3 lignes dans la configuration par d√©faut d&rsquo;un serveur IMAP</li><li>modifiant 8 lignes dans la configuration par d√©faut d&rsquo;une solution antispam</li></ul><p>Et parce que nous √©tions de tres bonne humeur et volontaires pour faire un petit pas de plus, nous avons impl√©ment√© un apprentissage Spam / Ham de Rspamd en :</p><ul><li>modifiant environ 20 lignes dans la configuration par d√©faut d&rsquo;un serveur IMAP</li><li>copiant 4 scripts Sieve dans un r√©pertoire</li></ul><p>On admettra qu&rsquo;un nouvel arrivant va devoir fournir quelques efforts pour trouver tout √ßa sans aide, mais aucune de ces t√¢ches n&rsquo;est r√©ellement difficile ou complexe.
De plus, la plupart sont des op√©rations de mises en place qui ne sont r√©alis√©es qu&rsquo;une fois ; on n&rsquo;√©dite pas la zone DNS ou un reverse DNS tous les deux jours, tout comme on ne touche pas une configuration en place qui fonctionne tant qu&rsquo;il n&rsquo;y a pas de nouveau cas d&rsquo;utilisation.</p><p>Pour citer les plus r√©fractaires √† l&rsquo;auto-h√©bergement, il peut y avoir des maintenances pour g√©rer les cons√©quences d&rsquo;une blacklist, mais il n&rsquo;y a aucun sc√©nario dans lequel ladite maintenance impliquerait autant de travail que la mise en place que nous venons de faire‚Ä¶ et qui au final se r√©plique en 10 minutes chrono une fois r√©alis√©e une premi√®re fois pour se faire la main.</p><div id=quelle-est-la-prochaine-√©tape- class=anchor></div><h2 class="relative group">Quelle est la prochaine √©tape ?
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#quelle-est-la-prochaine-%c3%a9tape- aria-label=Anchor>#</a></span></h2><p>Votre prochaine √©tape est de mettre en place de la redondance pour vous assurer qu&rsquo;une panne de votre serveur de mail n&rsquo;entraine pas de perte de mail.</p><p>En pratique, la plupart des serveurs de mails retentent une √©mission de multiples fois si la destination est inaccessible donc, <strong>m√™me</strong> en cas de panne, la plupart de vos mails seront temporis√©s par votre √©metteur et retransmis quand votre serveur sera de nouveau accessible.</p><p>En th√©orie, on veut tout de m√™me faire les choses bien, et reposer sur la responsabilit√© des autres √† g√©rer nos pannes n&rsquo;est pas tr√®s poli.
Vous devez mettre en place un serveur secondaire, vous arranger entre amis pour √™tre serveurs secondaires les uns des autres, ou m√™me vous souscrire √† un service qui offre du mail secondaire.
N&rsquo;importe quoi qui puisse permettre de couvrir vos arri√®res lorsque votre serveur primaire tombe.</p><p>Ensuite, peu importe la m√©thode choisie, il vous faudra :</p><ul><li>ajouter un enregistrement MX suppl√©mentaire dans votre zone DNS</li><li>configurer le serveur secondaire pour retransmettre les mails au serveur primaire</li></ul><p>On est loin de la haute voltige.</p><div id=est-ce-quon-a-vraiment-fini- class=anchor></div><h2 class="relative group">Est-ce qu&rsquo;on a vraiment fini ?
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#est-ce-quon-a-vraiment-fini- aria-label=Anchor>#</a></span></h2><p>Je vais probablement √©crire une s√©rie d&rsquo;article pour discuter de la r√©putation, ainsi que des m√©canismes en place chez les Big Mailer Corps qui provoquent des pannes de distribution.</p><p>Si ce sont des sujets d&rsquo;int√©r√™t et que j&rsquo;ai du feedback positif, j&rsquo;√©crirais plus souvent sur les concepts autour de la d√©liverabilit√©, sinon je reprendrais mes anciennes activit√©s : √©crire mes rapports mensuels sur mes contributions opensource. √Ä vous de me dire :-)</p><p>Finalement, dans cet article j&rsquo;ai d√©crit un setup vraiment simple mais il y a des tonnes de choses int√©ressantes √† faire avec les infrastructures de mail, si vous n&rsquo;avez pas peur d&rsquo;aller plus loin.</p><p>Je construis actuellement une infrastructure de mail pour un future service commercial d&rsquo;h√©bergement.
L&rsquo;infrastructure s&rsquo;√©tend sur plusieurs data centers dans plusieurs pays, a des serveurs secondaires capable d&rsquo;encaisser des pannes tr√®s s√©rieuses des serveurs primaires, peut facilement monter √† l&rsquo;√©chelle sur des pics de volume, elle d√©corelle le trafic entrant et sortant pour permettre de fournir des services partiels, peut facilement re-router le trafic entre des machines pour contourner des pannes, tout en fournissant des services IMAP √† des comptes virtuels sur une multitude de domaines, avec des backups quotidiens.
L&rsquo;infrastructure me coute‚Ä¶ moins de 75 EUR par mois.
Elle est √©galement tr√®s simple, la plupart des machines sont des installations par d√©faut d&rsquo;OpenBSD avec <strong>tr√®s peu</strong> de changements au syst√®me de base.</p><p>Si lire √† propos de ce genre de mises en place vous int√©resse, je peux √©crire √† ce sujet pour aider un maximum de personnes √† monter un maximum d&rsquo;alternatives aux Big Mailer Corps, ce qui est au final mon souhait.</p><p>Merci de m&rsquo;avoir lu, je n&rsquo;ai pas de soundcloud, mais <a href=https://patreon.com/gilles target=_blank>j&rsquo;ai un patreon</a> et un <a href=https://github.com/sponsors/poolpOrg target=_blank>github</a> si vous voulez me sponsoriser, ou <strong>utiliser les icones en dessous du lien de commentaires</strong> pour partager cet article sur les reseaux sociaux.</p></br></br></div><script>var oid="views_posts/2019-12-23/index.md",oid_likes="likes_posts/2019-12-23/index.md"</script><script type=text/javascript src=/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="dark:text-neutral-300 text-sm"><b>Again...</b><br><br>If you reached the end of this article,
<b>please ‚ù§Ô∏è</b> consider <b>sharing on social networks</b> to boost its visibility !<br>Also <b>consider leaving <u><a href=#comments>comments</a></u></b> below,
if only to let me know if you liked it or not.
Don't forget,
<b>there's a <u><a href=https://discord.com/invite/YC6j4rbvSk>Discord</a></u> server too</b>,
feel free to hop in !</span></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;text=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;description=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;quote=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;subject=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://poolp.org/posts/2019-12-23/mettre-en-place-un-serveur-de-mail-avec-opensmtpd-dovecot-et-rspamd/&amp;resubmit=true&amp;title=Mettre%20en%20place%20un%20serveur%20de%20mail%20avec%20OpenSMTPD,%20Dovecot%20et%20Rspamd" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><div class=pt-3><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=pt-3><div id=comments><script src=https://giscus.app/client.js data-repo=poolpOrg/poolp.org data-repo-id="MDEwOlJlcG9zaXRvcnkxMjYxODk2MjA=" data-category=Articles data-category-id=DIC_kwDOB4WANM4B-Zf1 data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/2019-12-15/decentralisons-smtp-pour-le-bien-commun/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">D√©centralisons SMTP pour le bien commun</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2019-12-15 13:05:00 +0200 +0200">15 December 2019</time></span></span></a></span>
<span><a class="flex text-right group ml-3" href=/posts/2019-12-24/december-2019-opensmtpd-and-filters-work-articles-and-goodies/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">December 2019: OpenSMTPD and filters work, articles and goodies</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2019-12-24 09:31:00 +0200 +0200">24 December 2019</time></span></span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Copyright ¬© Gilles Chehade - poolp.org
-
<u><a href=/legal/>Legal notice</a></u></p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://poolp.org style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=poolporg data-description="Support me on Buy me a coffee!" data-message="Support me !" data-color=#FFDD00 data-position=left data-x_margin=18 data-y_margin=18></script><div class=discord-button onclick='document.querySelector(".discord-dialog").className="discord-dialog discord-dialog--active"'><svg class="discord-button__icon" viewBox="0 0 24 24"><path d="M22 24l-5.25-5L17.38 21H4.5A2.5 2.5.0 012 18.5V3.5A2.5 2.5.0 014.5 1h15A2.5 2.5.0 0122 3.5V24M12 6.8c-2.68.0-4.56 1.15-4.56 1.15 1.03-.92 2.83-1.45 2.83-1.45l-.17-.17C8.41 6.36 6.88 7.53 6.88 7.53c-1.72 3.59-1.61 6.69-1.61 6.69 1.4 1.81 3.48 1.68 3.48 1.68L9.46 15c-1.25-.27-2.04-1.38-2.04-1.38S9.3 14.9 12 14.9s4.58-1.28 4.58-1.28S15.79 14.73 14.54 15L15.25 15.9S17.33 16.03 18.73 14.22C18.73 14.22 18.84 11.12 17.12 7.53c0 0-1.53-1.17-3.22-1.2l-.17.17s1.8.53 2.83 1.45c0 0-1.88-1.15-4.56-1.15M9.93 10.59c.65.0 1.18.57 1.17 1.27C11.1 12.55 10.58 13.13 9.93 13.13 9.29 13.13 8.77 12.55 8.77 11.86 8.77 11.16 9.28 10.59 9.93 10.59m4.17.0c.65.0 1.17.57 1.17 1.27C15.27 12.55 14.75 13.13 14.1 13.13 13.46 13.13 12.94 12.55 12.94 11.86 12.94 11.16 13.45 10.59 14.1 10.59z"/></svg></div><div class=discord-dialog><div class=discord-dialog__header><a href=https://discordapp.com><svg class="discord-dialog__logo" viewBox="0 0 532 130"><path d="M53.2 20.3H20v37.6l22.1 20V41.4H54c7.5.0 11.2 3.7 11.2 9.5v27.9c0 5.8-3.5 9.7-11.2 9.7H20v21.2h33.2c17.8.1 34.5-8.8 34.5-29.4V50.2c0-20.8-16.7-29.9-34.5-29.9zM227.3 80.4V49.6c0-11.1 19.8-13.7 25.8-2.5l18.3-7.5C264.3 23.7 251.1 19 240.2 19c-17.8.0-35.4 10.4-35.4 30.6v30.8c0 20.3 17.6 30.6 35 30.6 11.2.0 24.6-5.6 32-20.1l-19.6-9.1C247.4 94.2 227.3 91.2 227.3 80.4zM166.7 53.8c-6.9-1.5-11.5-4-11.8-8.3.4-10.4 16.3-10.7 25.6-.8l14.7-11.4C186 22 175.6 19 164.8 19c-16.3.0-32.1 9.2-32.1 26.8.0 17.1 13 26.2 27.3 28.4 7.3 1 15.4 3.9 15.2 9-.6 9.6-20.2 9.1-29.1-1.8L132 94.8c8.3 10.7 19.6 16.2 30.2 16.2 16.3.0 34.4-9.5 35.1-26.8C198.3 62.2 182.5 56.7 166.7 53.8zM99.8 109.7h22.4V20.3H99.8v89.4zM477.5 20.3h-33.2v37.6l22.1 20V41.4h11.8c7.5.0 11.2 3.7 11.2 9.5v27.9c0 5.8-3.5 9.7-11.2 9.7h-34v21.2h33.2c17.8.1 34.5-8.8 34.5-29.4V50.2C512 29.4 495.3 20.3 477.5 20.3zM314.6 19c-18.4.0-36.7 10.1-36.7 30.7v30.6c0 20.5 18.4 30.7 36.9 30.7 18.4.0 36.7-10.2 36.7-30.7V49.7C351.5 29.2 333 19 314.6 19zM329 80.3c0 6.4-7.2 9.7-14.3 9.7-7.2.0-14.4-3.2-14.4-9.7V49.7c0-6.6 7-10.1 14-10.1 7.3.0 14.7 3.2 14.7 10.1V80.3zM431.8 49.7c-.5-21-14.7-29.4-33-29.4h-35.5v89.5H386V81.3h4l20.6 28.4h28L414.4 79C425.2 75.6 431.8 66.3 431.8 49.7zM399.2 61.8H386V41.4h13.2c14.2.0 14.2 20.4.0 20.4z"/></svg></a></div><div class=discord-dialog__close-button onclick='document.querySelector(".discord-dialog").className="discord-dialog"'><svg viewBox="0 0 24 24"><path fill="#000" d="M13.46 12 19 17.54V19H17.54L12 13.46 6.46 19H5V17.54L10.54 12 5 6.46V5H6.46L12 10.54 17.54 5H19V6.46L13.46 12z"/></svg></div><div class=discord-dialog__container><div class=discord-dialog__guild>You're invited to join my Discord server</div>This is a chat server where I hang out, discuss my projects and sometimes screencast as I work on them.<br><br>Feel free to hop in, talk about your own projects, share your thoughts:
<b>this is a virtual coworking room for anyone to join</b>.</div><div class=discord-dialog__footer><a href=https://discord.gg/YC6j4rbvSk class=discord-dialog__btn>Join the server now</a></div></div></html>